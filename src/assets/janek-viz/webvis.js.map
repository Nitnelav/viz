{"version":3,"sources":["webpack:///webvis.js","webpack:///./src/contracts/Configuration.js","webpack:///./src/contracts/Rectangle.js","webpack:///./src/modell/DataProvider.js","webpack:///./src/modell/Playback.js","webpack:///./src/view/MapInteractionController.js","webpack:///./src/view/MapState.js","webpack:///./src/communication/http.js","webpack:///./src/view/Shader.js","webpack:///./src/view/DrawingController.js","webpack:///./src/modell/background/DataFetcher.worker.js","webpack:///./src/modell/background/GeoJsonParser.worker.js","webpack:///./src/modell/LayerData.js","webpack:///./src/modell/SnapshotData.js","webpack:///./src/modell/background/WorkerFacade.js","webpack:///./src/view/BufferHolder.js","webpack:///./src/view/assets/circle-32.png","webpack:///./src/view/assets/circle-64.png","webpack:///./src/view/assets/triangle-32.png","webpack:///./src/view/assets/triangle-64.png","webpack:///./src/Webvis.js"],"names":["Webvis","webpackJsonpWebvis","module","exports","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","Config","parameters","this","_setCanvasId","canvasId","_setColors","colors","_setBackendUrl","dataUrl","_setCache","cache","_listeners","callback","push","index","indexOf","splice","id","background","network","agents","selectedAgent","selectedPlan","url","cachedSnapshots","minRequestSize","oldSnapshotsToKeep","firstTimestep","lastTimestep","timestepSize","bounds","_broadCastServerConfigUpdated","Configuration","createConfiguration","updateServerConfiguration","_updateServerConfig","getConfig","Error","default","Rectangle","left","right","top","bottom","_left","_right","_top","_bottom","get","Math","abs","centerX","centerY","width","height","rectangle","offsetX","offsetY","_interopRequireDefault","obj","__esModule","DataProvider","undefined","_WorkerFacade","_DataFetcherWorker","_DataFetcherWorker2","_GeoJsonParserWorker","_GeoJsonParserWorker2","_SnapshotData","_LayerData","_Rectangle","_Configuration","_Configuration2","_this","_config","_speedFactor","_agentRequests","_requestNumber","_isLoadingPlan","_maxConcurrentSnapshotRequests","workerFacade","WorkerFacade","name","data","onWorkerEvent","layerData","LayerData","snapshotData","set","_networkDataChanged","_geoJsonDataChanged","_isFetchingDataChanged","destroy","_parserWorkerFacade","postWorkerMessage","params","idIndex","_onFetchingDataChanged","timestep","getSnapshot","ids","lastRequestedTimestep","result","hasSnapshotFor","lastCachedTimestep","_isSmallerThanLastTimestep","_isBufferSuficient","fromTimestep","_loadSnapshots","geoJson","layerName","z","color","_this2","removeLayer","getLayer","clearSnapshots","isFetchingData","requestSize","_getRequestSize","requestNumber","requestParameters","speedFactor","size","response","smallestSnapshotToKeep","addSnapshotsAndForgetOldOnes","console","log","SnapshotData","layer","createLayer","addLayer","_numberOfCachedTimestepsAhead","_handleConfigDataReceived","_handleSnapshotDataReceived","_handlePlanDataReceived","_handleGeoJsonParsed","Playback","dataProvider","subscribeServerConfigUpdated","_onServerConfigUpdated","_timestepFraction","timeBetweenFrames","_currentTimestep","_shouldRelaodShansphots","clearCache","_onTimestepChanged","timestepFraction","snapshot","currentTimestep","time","position","Float32Array","nextPosition","shouldInterpolate","firstCachedTimestep","_incrementCurrentTime","_reachedEndOfPlayback","_resetToFirstTimestep","modulo","_setCurrentTime","currentTime","nextTime","newFraction","_incrementCurrentTimestep","nextTimestep","_setCurrentTimestep","newSpeedFactor","MapInteractionController","mapState","_mapState","canvas","document","getElementById","_boundPointerDown","e","onPointerDown","_boundPointerUp","onPointerUp","_boundPointerMove","onPointerMove","_boundMouseWheel","onMouseWheel","pointerDown","pointerUp","pointerMove","addEventListener","_clicked","_redrawNeeded","removeEventListener","args","_isMouseDown","_oldX","_oldY","_mouseMoved","point","transformCoordinate","dx","dy","moveMap","x","y","deltaY","zoomInReCenter","zoomOutReCenter","preventDefault","stopPropagation","MapState","_three","_bounds","_scale","_camera","OrthographicCamera","frustumCulled","_adjustCameraToBounds","toWidth","toHeight","createRectFromCenterDimensions","aspect","newBounds","createRectFromOffset","_zoomReCenter","ZOOMFACTOR","factor","zoomCenterX","zoomCenterY","relativeX","relativeY","updateProjectionMatrix","Http","_dataUrl","success","error","URLPATH_CONFIGURATION","makePostRequest","RESPONSETYPE_TEXT","URLPATH_NETWORK","RESPONSETYPE_BUFFER","URLPATH_SNAPSHOTS","URLPATH_PLAN","responseType","request","XMLHttpRequest","onreadystatechange","readyStateChangedHandler","dataString","JSON","stringify","open","setRequestHeader","send","isRequestDone","isStatusSuccess","status","message","readyState","DONE","STATUS_OK","Shader","DrawingController","_MapState","_MapInteractionController","_BufferHolder","_triangle","_circle","initialize","resize","controller","_interactionController","clicked","p","raycast","redrawNeeded","renderOnce","_playback","_dataProvider","renderer","WebGLRenderer","antialias","setPixelRatio","window","devicePixelRatio","_bufferHolder","BufferHolder","interactionController","_raycaster","Raycaster","_boundResize","stopPlayback","dispose","_this3","rawBounds","resizeMapEnclose","networkDataChanged","onNetworkDataChanged","geoJsonDataChanged","onGeoJsonDataChanged","loadNetworkData","clearNetworkBuffer","loadNetworkBuffer","clearGeoJsonBuffer","loadGeoJsonBuffer","clientWidth","clientHeight","resizeMap","setViewport","hasAgentLayer","Points","threshold","scale","ray","Vector3","agentLayer","AGENT_LAYER","intersects","intersectObject","getId","playback","loadPlan","updateAgentBufferUniform","shouldRender","loadAgentBuffer","render","_this4","requestAnimationFrame","isAnimationFrame","incrementTime","_animateAgents","scene","camera","shouldLoadNewSnapshot","getSnapshotForCurrentTimestep","updateAgentBufferAttribute","Worker","_layers","foundIndex","find","entry","points","lines","shapeVertices","shapeNormals","snapshots","Array","_hasSnapshots","smallestTimestepToKeepCached","firstTimestepToAppend","indexToKeep","_getIndexForTimestep","_canTimestepBeAppended","_makeSnapshotsAppendable","slice","concat","RangeError","floor","worker","eventCallback","boundHandelWorkerMessage","handleWorkerMessage","terminate","then","Date","now","type","onWorkerMessageReceived","methodName","postMessage","method","transferrables","_Shader","_triangle2","_circle2","_scene","Scene","Color","_hasLayer","_clearBuffer","NETWORK_LAYER","children","getObjectByName","remove","links","_createLineMesh","add","shaderMaterial","ShaderMaterial","vertexShader","interpolatePositionsVertexShader","fragmentShader","interpolatePositionsFragmentShader","uniforms","hitTestThreshold","selectedId","mousePosition","Vector2","selectedColor","triangle","_createTexture","circle","transparent","alphaTest","BufferGeometry","_createAgentBufferAttribute","_createPointsMesh","shapes","_createShapeMesh","itemSize","attribute","BufferAttribute","geometry","addAttribute","array","getAttribute","setArray","needsUpdate","material","LineBasicMaterial","_createBufferGeometry","mesh","LineSegments","_setMeshProperties","image","PointsMaterial","sizeAttenuation","map","vertices","normals","MeshBasicMaterial","Mesh","positions","verticesNeedUpdate","texture","TextureLoader","load","t","flipY","magFilter","NearestFilter","minFilter","_DrawingController","_Playback","_DataProvider","configParameters","_handleServerConfigChanged","loadServerConfig","isFetchingDataChanged","_handleIsFetchingDataChanged","drawingController","_onServerConfigChanged","onTimestepChanged","_onFetchingData","startPlayback","seekTimestep","addGeoJsonLayer","removeGeoJsonLayer"],"mappings":"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","file":"webvis.js","sourcesContent":["var Webvis =\nwebpackJsonpWebvis([0],[\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Config = function () {\n    function Config(parameters) {\n        _classCallCheck(this, Config);\n\n        this._setCanvasId(parameters.canvasId);\n        this._setColors(parameters.colors);\n        this._setBackendUrl(parameters.dataUrl);\n        this._setCache(parameters.cache);\n        this._listeners = [];\n    }\n\n    _createClass(Config, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._listeners = null;\n        }\n    }, {\n        key: 'subscribeServerConfigUpdated',\n        value: function subscribeServerConfigUpdated(callback) {\n            this._listeners.push(callback);\n        }\n    }, {\n        key: 'unsubscribeServerConfigUpdated',\n        value: function unsubscribeServerConfigUpdated(callback) {\n            var index = this._listeners.indexOf(callback);\n            this._listeners.splice(index, 1);\n        }\n    }, {\n        key: '_broadCastServerConfigUpdated',\n        value: function _broadCastServerConfigUpdated() {\n            for (var i = 0; i < this._listeners.length; i++) {\n                this._listeners[i]();\n            }\n        }\n    }, {\n        key: '_setCanvasId',\n        value: function _setCanvasId(id) {\n            this.canvasId = id ? id : 'canvas';\n        }\n    }, {\n        key: '_setColors',\n        value: function _setColors(colors) {\n            if (!colors) {\n                colors = {};\n            }\n\n            this.colors = {\n                background: colors.background ? colors.background : 0xECF0F1,\n                network: colors.network ? colors.network : 0x2C3E50,\n                agents: colors.agents ? colors.agents : 0x3498DB,\n                selectedAgent: colors.selectedAgent ? colors.selectedAgent : 0xE74C3C,\n                selectedPlan: colors.selectedPlan ? colors.selectedPlan : 0xE74C3C\n            };\n        }\n    }, {\n        key: '_setBackendUrl',\n        value: function _setBackendUrl(url) {\n            this.dataUrl = url ? url : 'http://localhost:3001/';\n        }\n    }, {\n        key: '_setCache',\n        value: function _setCache(cache) {\n            if (!cache) {\n                cache = {};\n            }\n            this.cache = {\n                cachedSnapshots: cache.cachedSnapshots ? cache.cachedSnapshots : 1200,\n                minRequestSize: cache.minRequestSize ? cache.minRequestSize : 100,\n                oldSnapshotsToKeep: cache.oldSnapshotsToKeep ? cache.oldSnapshotsToKeep : 900\n            };\n        }\n    }, {\n        key: '_updateServerConfig',\n        value: function _updateServerConfig(parameters) {\n            this.firstTimestep = parameters.firstTimestep;\n            this.lastTimestep = parameters.lastTimestep;\n            this.timestepSize = parameters.timestepSize;\n            this.bounds = parameters.bounds;\n            this._broadCastServerConfigUpdated();\n        }\n    }]);\n\n    return Config;\n}();\n\nvar instance = void 0;\n\nvar Configuration = {\n    createConfiguration: function createConfiguration(parameters) {\n        instance = new Config(parameters);\n    },\n\n    updateServerConfiguration: function updateServerConfiguration(parameters) {\n        instance._updateServerConfig(parameters);\n    },\n\n    getConfig: function getConfig() {\n        if (!instance) {\n            throw Error('configuration was not created yet');\n        }\n        return instance;\n    }\n\n};\n\nexports.default = Configuration;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Rectangle = function () {\n    _createClass(Rectangle, [{\n        key: \"left\",\n        get: function get() {\n            return this._left;\n        }\n    }, {\n        key: \"right\",\n        get: function get() {\n            return this._right;\n        }\n    }, {\n        key: \"top\",\n        get: function get() {\n            return this._top;\n        }\n    }, {\n        key: \"bottom\",\n        get: function get() {\n            return this._bottom;\n        }\n    }, {\n        key: \"width\",\n        get: function get() {\n            return Math.abs(this._right - this._left);\n        }\n    }, {\n        key: \"height\",\n        get: function get() {\n            return Math.abs(this._bottom - this._top);\n        }\n    }, {\n        key: \"centerX\",\n        get: function get() {\n            return (this.left + this.right) / 2;\n        }\n    }, {\n        key: \"centerY\",\n        get: function get() {\n            return (this.top + this.bottom) / 2;\n        }\n    }]);\n\n    function Rectangle(left, right, top, bottom) {\n        _classCallCheck(this, Rectangle);\n\n        this._left = left, this._right = right;\n        this._top = top;\n        this._bottom = bottom;\n    }\n\n    _createClass(Rectangle, [{\n        key: \"toJSON\",\n        value: function toJSON() {\n            return {\n                left: this._left,\n                right: this._right,\n                top: this._top,\n                bottom: this._bottom\n            };\n        }\n    }], [{\n        key: \"createRectFromCenterDimensions\",\n        value: function createRectFromCenterDimensions(centerX, centerY, width, height) {\n            var left = centerX - width / 2;\n            var right = centerX + width / 2;\n            var top = centerY + height / 2;\n            var bottom = centerY - height / 2;\n            return new Rectangle(left, right, top, bottom);\n        }\n    }, {\n        key: \"createRectFromOffset\",\n        value: function createRectFromOffset(rectangle, offsetX, offsetY) {\n            var left = rectangle.left + offsetX;\n            var right = rectangle.right + offsetX;\n            var top = rectangle.top + offsetY;\n            var bottom = rectangle.bottom + offsetY;\n            return new Rectangle(left, right, top, bottom);\n        }\n    }, {\n        key: \"createRectVerticallyFlipped\",\n        value: function createRectVerticallyFlipped(rectangle) {\n            return new Rectangle(rectangle.left, rectangle.right, -rectangle.top, -rectangle.bottom);\n        }\n    }]);\n\n    return Rectangle;\n}();\n\nexports.Rectangle = Rectangle;\n\n/***/ }),\n/* 2 */,\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.DataProvider = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _WorkerFacade = __webpack_require__(14);\n\nvar _DataFetcherWorker = __webpack_require__(10);\n\nvar _DataFetcherWorker2 = _interopRequireDefault(_DataFetcherWorker);\n\nvar _GeoJsonParserWorker = __webpack_require__(11);\n\nvar _GeoJsonParserWorker2 = _interopRequireDefault(_GeoJsonParserWorker);\n\nvar _SnapshotData = __webpack_require__(13);\n\nvar _LayerData = __webpack_require__(12);\n\nvar _Rectangle = __webpack_require__(1);\n\nvar _http = __webpack_require__(7);\n\nvar _Configuration = __webpack_require__(0);\n\nvar _Configuration2 = _interopRequireDefault(_Configuration);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DataProvider = function () {\n    _createClass(DataProvider, [{\n        key: 'isFetchingData',\n        get: function get() {\n            return this._agentRequests >= this._maxConcurrentSnapshotRequests || this._isLoadingPlan;\n        }\n    }, {\n        key: 'lastCachedTimestep',\n        get: function get() {\n            return this.snapshotData.lastTimestep;\n        }\n    }, {\n        key: 'firstCachedTimestep',\n        get: function get() {\n            return this.snapshotData.firstTimestep;\n        }\n    }, {\n        key: 'networkDataChanged',\n        set: function set(callback) {\n            this._networkDataChanged = callback;\n        }\n    }, {\n        key: 'geoJsonDataChanged',\n        set: function set(callback) {\n            this._geoJsonDataChanged = callback;\n        }\n    }, {\n        key: 'isFetchingDataChanged',\n        set: function set(callback) {\n            this._isFetchingDataChanged = callback;\n        }\n    }, {\n        key: 'speedFactor',\n        set: function set(value) {\n\n            if (value >= 1.0) this._speedFactor = value;else this._speedFactor = 1.0;\n        }\n    }]);\n\n    function DataProvider() {\n        var _this = this;\n\n        _classCallCheck(this, DataProvider);\n\n        this._config = _Configuration2.default.getConfig();\n        this._speedFactor = 1.0;\n        this._agentRequests = 0;\n        this._requestNumber = 0;\n        this._isLoadingPlan = false;\n        this._maxConcurrentSnapshotRequests = 1;\n        this.workerFacade = new _WorkerFacade.WorkerFacade(_DataFetcherWorker2.default, function (name, data) {\n            return _this.onWorkerEvent(name, data);\n        });\n        this.layerData = new _LayerData.LayerData();\n    }\n\n    _createClass(DataProvider, [{\n        key: 'destroy',\n        value: function destroy() {\n            this.workerFacade.destroy();\n            if (this._parserWorkerFacade) {\n                this._parserWorkerFacade.destroy();\n            }\n            this.snapshotData = null;\n            this.layerData = null;\n            this._networkDataChanged = null;\n            this._geoJsonDataChanged = null;\n            this._isFetchingDataChanged = null;\n        }\n    }, {\n        key: 'loadServerConfig',\n        value: function loadServerConfig() {\n            this.workerFacade.postWorkerMessage('initialize', { dataUrl: this._config.dataUrl });\n            this.workerFacade.postWorkerMessage('getConfig', { id: 'id' });\n        }\n    }, {\n        key: 'loadNetworkData',\n        value: function loadNetworkData() {\n            this.workerFacade.postWorkerMessage('getNetworkData', {});\n        }\n    }, {\n        key: 'loadPlan',\n        value: function loadPlan(id) {\n\n            var params = {\n                idIndex: id\n            };\n            this.workerFacade.postWorkerMessage('getPlan', params);\n            this._isLoadingPlan = true;\n            this._onFetchingDataChanged();\n        }\n    }, {\n        key: 'getId',\n        value: function getId(index, timestep) {\n            var snapshot = this.snapshotData.getSnapshot(timestep, this._speedFactor);\n            return snapshot.ids[index];\n        }\n    }, {\n        key: 'getSnapshot',\n        value: function getSnapshot(timestep) {\n\n            this.lastRequestedTimestep = timestep;\n            var result = void 0;\n            //1. Get snapshot from chache if available\n            if (this.snapshotData.hasSnapshotFor(timestep)) {\n                result = this.snapshotData.getSnapshot(timestep, this._speedFactor);\n            } else {\n                result = {};\n            }\n\n            //2. Make sure there are enough snapshots chached\n            //if not tell background worker to load more snapshots\n            var lastCachedTimestep = this.snapshotData.lastTimestep;\n\n            if (this._isSmallerThanLastTimestep(lastCachedTimestep) && !this._isBufferSuficient(timestep)) {\n\n                var fromTimestep = void 0;\n                if (lastCachedTimestep < timestep) {\n                    fromTimestep = timestep;\n                } else {\n                    fromTimestep = lastCachedTimestep;\n                }\n\n                this._loadSnapshots(fromTimestep);\n            }\n\n            //3. return the snapshot or empty object\n            return result;\n        }\n    }, {\n        key: 'addGeoJsonLayer',\n        value: function addGeoJsonLayer(geoJson, layerName, z, color) {\n            var _this2 = this;\n\n            var parameters = {\n                layerName: layerName,\n                z: z,\n                color: color,\n                geoJson: geoJson\n            };\n            this._parserWorkerFacade = new _WorkerFacade.WorkerFacade(_GeoJsonParserWorker2.default, function (name, data) {\n                return _this2.onWorkerEvent(name, data);\n            });\n            this._parserWorkerFacade.postWorkerMessage('initialize', {});\n            this._parserWorkerFacade.postWorkerMessage('parseGeoJson', parameters);\n        }\n    }, {\n        key: 'removeGeoJsonLayer',\n        value: function removeGeoJsonLayer(layerName) {\n            this.layerData.removeLayer(layerName);\n            this._geoJsonDataChanged(layerName);\n        }\n    }, {\n        key: 'getLayer',\n        value: function getLayer(layerName) {\n            return this.layerData.getLayer(layerName);\n        }\n    }, {\n        key: 'clearCache',\n        value: function clearCache() {\n            this.snapshotData.clearSnapshots();\n\n            //we also need to reload new agents\n            if (this.isFetchingData) {\n                this._maxConcurrentSnapshotRequests++;\n            }\n        }\n    }, {\n        key: '_loadSnapshots',\n        value: function _loadSnapshots(fromTimestep) {\n            if (this.isFetchingData) return;\n\n            this._requestNumber++;\n            var requestSize = this._getRequestSize(fromTimestep);\n\n            var params = {\n                requestNumber: this._requestNumber,\n                requestParameters: {\n                    fromTimestep: fromTimestep,\n                    speedFactor: this._speedFactor,\n                    size: requestSize,\n                    bounds: new _Rectangle.Rectangle(1, 1, 1, 1)\n                }\n            };\n            this._agentRequests++;\n            this.workerFacade.postWorkerMessage('getSnapshotData', params);\n            this._onFetchingDataChanged();\n        }\n    }, {\n        key: '_handleSnapshotDataReceived',\n        value: function _handleSnapshotDataReceived(response) {\n\n            if (response.requestNumber === this._requestNumber) {\n                var smallestSnapshotToKeep = this.lastRequestedTimestep;\n\n                if (smallestSnapshotToKeep < this.snapshotData.lastTimestep) {\n                    smallestSnapshotToKeep = this.lastRequestedTimestep - this._config.cache.oldSnapshotsToKeep * this._config.timestepSize;\n                }\n                this.snapshotData.addSnapshotsAndForgetOldOnes(response.data, smallestSnapshotToKeep, this._speedFactor);\n            } else {\n                this._maxConcurrentSnapshotRequests--;\n                console.log('ignore received snapshot since it is outdated');\n            }\n            this._agentRequests--;\n            this._onFetchingDataChanged();\n        }\n    }, {\n        key: '_handleConfigDataReceived',\n        value: function _handleConfigDataReceived(data) {\n            _Configuration2.default.updateServerConfiguration(data);\n            this.snapshotData = new _SnapshotData.SnapshotData(data.timestepSize);\n            this.lastTimestep = data.lastTimestep;\n            this.firstTimestep = data.firstTimestep;\n        }\n    }, {\n        key: '_handlePlanDataReceived',\n        value: function _handlePlanDataReceived(data) {\n            this._isLoadingPlan = false;\n            var name = 'selectedPlan';\n            var layer = _LayerData.LayerData.createLayer(name, -9.0, this._config.colors.selectedPlan, data);\n            this.layerData.addLayer(layer);\n            this._onFetchingDataChanged();\n            this._geoJsonDataChanged(name);\n        }\n    }, {\n        key: '_handleGeoJsonParsed',\n        value: function _handleGeoJsonParsed(data) {\n            var layer = _LayerData.LayerData.createLayer(data.layerName, data.z, data.color, data);\n            this.layerData.addLayer(layer);\n            this._geoJsonDataChanged(layer.name);\n        }\n    }, {\n        key: '_isBufferSuficient',\n        value: function _isBufferSuficient(timestep) {\n            return this._numberOfCachedTimestepsAhead(timestep) > this._config.cache.cachedSnapshots;\n        }\n    }, {\n        key: '_numberOfCachedTimestepsAhead',\n        value: function _numberOfCachedTimestepsAhead(timestep) {\n            return (this.snapshotData.lastTimestep - timestep) / this.snapshotData.timestepSize;\n        }\n    }, {\n        key: '_isSmallerThanLastTimestep',\n        value: function _isSmallerThanLastTimestep(timestep) {\n            return timestep + this.snapshotData.timestepSize * this._speedFactor <= this.lastTimestep;\n        }\n    }, {\n        key: '_getRequestSize',\n        value: function _getRequestSize(timestep) {\n            var size = this._numberOfCachedTimestepsAhead(this.lastRequestedTimestep);\n            if (this._config.cache.minRequestSize > size) {\n                size = this._config.cache.minRequestSize;\n            }\n            return size;\n        }\n    }, {\n        key: '_onFetchingDataChanged',\n        value: function _onFetchingDataChanged() {\n            if (this._isFetchingDataChanged) {\n                this._isFetchingDataChanged();\n            }\n        }\n    }, {\n        key: 'onWorkerEvent',\n        value: function onWorkerEvent(name, data) {\n            switch (name) {\n                case 'configDataReceived':\n                    this._handleConfigDataReceived(data);\n                    break;\n                case 'networkDataReceived':\n                    this._networkDataChanged(data);\n                    break;\n                case 'snapshotDataReceived':\n                    this._handleSnapshotDataReceived(data);\n                    break;\n                case 'planDataReceived':\n                    this._handlePlanDataReceived(data);\n                    break;\n                case 'geoJsonParsed':\n                    this._handleGeoJsonParsed(data);\n                    break;\n                default:\n                    throw new Error('no such event name: ' + name);\n            }\n        }\n    }]);\n\n    return DataProvider;\n}();\n\nexports.DataProvider = DataProvider;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Playback = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _DataProvider = __webpack_require__(3);\n\nvar _Configuration = __webpack_require__(0);\n\nvar _Configuration2 = _interopRequireDefault(_Configuration);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Playback = function () {\n    _createClass(Playback, [{\n        key: 'currentTimestep',\n        get: function get() {\n            return this._currentTimestep;\n        }\n    }, {\n        key: 'timestepFraction',\n        get: function get() {\n            return this._timestepFraction;\n        }\n    }, {\n        key: 'speedFactor',\n        set: function set(value) {\n\n            if (this._shouldRelaodShansphots(value)) {\n                this.dataProvider.clearCache();\n            }\n            this.dataProvider.speedFactor = value;\n            this._speedFactor = value;\n            this._timestepFraction = 0.0;\n        },\n        get: function get() {\n            return this._speedFactor;\n        }\n    }, {\n        key: 'onTimestepChanged',\n        set: function set(callback) {\n            this._onTimestepChanged = callback;\n        }\n    }]);\n\n    function Playback(dataProvider) {\n        var _this = this;\n\n        _classCallCheck(this, Playback);\n\n        this._config = _Configuration2.default.getConfig();\n        this._config.subscribeServerConfigUpdated(function () {\n            return _this._onServerConfigUpdated();\n        });\n\n        this._speedFactor = 1.0;\n        this.dataProvider = dataProvider;\n        this.dataProvider.speedFactor = this._speedFactor;\n\n        this._timestepFraction = 0;\n        var fps = 60;\n        this.timeBetweenFrames = 1000 / fps; //something like 16.7 ms for 60fps\n    }\n\n    _createClass(Playback, [{\n        key: '_onServerConfigUpdated',\n        value: function _onServerConfigUpdated() {\n            this._currentTimestep = this._config.firstTimestep;\n            this.firstTimestep = this._config.firstTimestep;\n            this.lastTimestep = this._config.lastTimestep;\n            this.timestepSize = this._config.timestepSize;\n        }\n    }, {\n        key: 'shouldLoadNewSnapshot',\n        value: function shouldLoadNewSnapshot() {\n            return this.timestepFraction === 0;\n        }\n    }, {\n        key: 'getSnapshotForCurrentTimestep',\n        value: function getSnapshotForCurrentTimestep() {\n\n            //1. Serve positions\n            var snapshot = this.dataProvider.getSnapshot(this.currentTimestep);\n            if (!snapshot.time) {\n                //return empty data\n                snapshot = {\n                    position: new Float32Array(0),\n                    nextPosition: new Float32Array(0),\n                    shouldInterpolate: new Float32Array(0),\n                    ids: new Float32Array(0)\n                };\n            }\n            return snapshot;\n        }\n    }, {\n        key: 'incrementTime',\n        value: function incrementTime() {\n            if (this.dataProvider.lastCachedTimestep > this.currentTimestep && this.currentTimestep >= this.dataProvider.firstCachedTimestep) {\n\n                this._incrementCurrentTime();\n            } else if (this._reachedEndOfPlayback(this.currentTimestep)) {\n                this._resetToFirstTimestep();\n            }\n        }\n    }, {\n        key: 'seekTimestep',\n        value: function seekTimestep(timestep) {\n\n            if (timestep > this.lastTimestep || timestep < this.firstTimestep) {\n                timestep = this.firstTimestep;\n            }\n\n            if (timestep < this.dataProvider.firstCachedTimestep) {\n                this.dataProvider.clearCache();\n            }\n            var modulo = timestep % this.timestepSize;\n            this._setCurrentTime(timestep - modulo);\n        }\n    }, {\n        key: 'isBuffering',\n        value: function isBuffering() {\n            return this.dataProvider.isFetchingData();\n        }\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n            this._onTimestepChanged = null;\n        }\n    }, {\n        key: '_incrementCurrentTime',\n        value: function _incrementCurrentTime() {\n\n            var currentTime = this.currentTimestep + this.timestepFraction * this.timestepSize;\n            var nextTime = currentTime + this.timestepSize * this._speedFactor;\n            var newFraction = (nextTime - this.currentTimestep) / this.timestepSize;\n\n            if (newFraction >= 1.0) {\n                this._incrementCurrentTimestep();\n                this._timestepFraction = 0.0;\n            } else {\n                this._timestepFraction = newFraction;\n            }\n        }\n    }, {\n        key: '_incrementCurrentTimestep',\n        value: function _incrementCurrentTimestep() {\n\n            var nextTimestep = 0;\n\n            if (this._speedFactor >= 1.0) {\n                nextTimestep = this.currentTimestep + this.timestepSize * this._speedFactor;\n            } else {\n                nextTimestep = this.currentTimestep + this.timestepSize;\n            }\n\n            if (this._reachedEndOfPlayback(nextTimestep)) {\n                this._resetToFirstTimestep();\n            } else {\n                this._setCurrentTimestep(nextTimestep);\n            }\n        }\n    }, {\n        key: '_setCurrentTime',\n        value: function _setCurrentTime(value) {\n            this._timestepFraction = 0;\n            this._setCurrentTimestep(value);\n        }\n    }, {\n        key: '_setCurrentTimestep',\n        value: function _setCurrentTimestep(value) {\n            this._currentTimestep = value;\n            if (this._onTimestepChanged) {\n                this._onTimestepChanged(this._currentTimestep);\n            }\n        }\n    }, {\n        key: '_shouldRelaodShansphots',\n        value: function _shouldRelaodShansphots(newSpeedFactor) {\n            return this._speedFactor > 1.0 || newSpeedFactor > 1.0;\n        }\n    }, {\n        key: '_reachedEndOfPlayback',\n        value: function _reachedEndOfPlayback(timestep) {\n            return timestep + this.timestepSize * this._speedFactor > this.lastTimestep;\n        }\n    }, {\n        key: '_resetToFirstTimestep',\n        value: function _resetToFirstTimestep() {\n            this._setCurrentTime(this.firstTimestep);\n            this.dataProvider.clearCache();\n        }\n    }]);\n\n    return Playback;\n}();\n\nexports.Playback = Playback;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.MapInteractionController = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Rectangle = __webpack_require__(1);\n\nvar _Configuration = __webpack_require__(0);\n\nvar _Configuration2 = _interopRequireDefault(_Configuration);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MapInteractionController = function () {\n    _createClass(MapInteractionController, [{\n        key: 'clicked',\n        set: function set(callback) {\n            this._clicked = callback;\n        }\n    }, {\n        key: 'redrawNeeded',\n        set: function set(callback) {\n            this._redrawNeeded = callback;\n        }\n    }]);\n\n    function MapInteractionController(mapState) {\n        var _this = this;\n\n        _classCallCheck(this, MapInteractionController);\n\n        this._mapState = mapState;\n\n        var canvas = document.getElementById(_Configuration2.default.getConfig().canvasId);\n        this._boundPointerDown = function (e) {\n            return _this.onPointerDown(e);\n        };\n        this._boundPointerUp = function (e) {\n            return _this.onPointerUp(e);\n        };\n        this._boundPointerMove = function (e) {\n            return _this.onPointerMove(e);\n        };\n        this._boundMouseWheel = function (e) {\n            return _this.onMouseWheel(e);\n        };\n\n        var pointerDown = 'onpointerdown' in canvas ? 'pointerdown' : 'mousedown';\n        var pointerUp = 'onpointerup' in canvas ? 'pointerup' : 'mouseup';\n        var pointerMove = 'onpointermove' in canvas ? 'pointermove' : 'mousemove';\n\n        canvas.addEventListener(pointerDown, this._boundPointerDown);\n        canvas.addEventListener(pointerUp, this._boundPointerUp);\n        canvas.addEventListener(pointerMove, this._boundPointerMove);\n        canvas.addEventListener('wheel', this._boundMouseWheel);\n    }\n\n    _createClass(MapInteractionController, [{\n        key: 'destroy',\n        value: function destroy() {\n            var canvas = document.getElementById(_Configuration2.default.getConfig().canvasId);\n            canvas.removeEventListener('mousedown', this._boundPointerDown);\n            canvas.removeEventListener('mouseup', this._boundPointerUp);\n            canvas.removeEventListener('mousemove', this._boundPointerMove);\n            canvas.removeEventListener('pointerdown', this._boundPointerDown);\n            canvas.removeEventListener('pointerup', this._boundPointerUp);\n            canvas.removeEventListener('pointermove', this._boundPointerMove);\n            canvas.removeEventListener('wheel', this._boundMouseWheel);\n\n            this._redrawNeeded = null;\n            this._clicked = null;\n        }\n    }, {\n        key: 'onPointerDown',\n        value: function onPointerDown(args) {\n            this._isMouseDown = true;\n            this._oldX = args.offsetX;\n            this._oldY = args.offsetY;\n        }\n    }, {\n        key: 'onPointerUp',\n        value: function onPointerUp(args) {\n            this._isMouseDown = false;\n            if (!this._mouseMoved) {\n                //it's a click\n                var point = this._mapState.transformCoordinate(args.offsetX, args.offsetY);\n                this._clicked(point);\n            }\n            this._mouseMoved = false;\n        }\n    }, {\n        key: 'onPointerMove',\n        value: function onPointerMove(args) {\n            if (this._isMouseDown) {\n                var dx = args.offsetX - this._oldX;\n                var dy = args.offsetY - this._oldY;\n                if (dx != 0 || dy != 0) {\n                    this._mouseMoved = true;\n                }\n                this._oldX = args.offsetX;\n                this._oldY = args.offsetY;\n                this._mapState.moveMap(dx, -dy);\n                this._redrawNeeded();\n            }\n        }\n    }, {\n        key: 'onMouseWheel',\n        value: function onMouseWheel(args) {\n\n            var x = args.offsetX;\n            var y = args.offsetY;\n\n            if (args.deltaY < 0) {\n                this._mapState.zoomInReCenter(x, y);\n            } else {\n                this._mapState.zoomOutReCenter(x, y);\n            }\n            this._redrawNeeded();\n            args.preventDefault();\n            args.stopPropagation();\n        }\n    }]);\n\n    return MapInteractionController;\n}();\n\nexports.MapInteractionController = MapInteractionController;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.MapState = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Rectangle = __webpack_require__(1);\n\nvar _three = __webpack_require__(2);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MapState = function () {\n    _createClass(MapState, [{\n        key: 'bounds',\n        get: function get() {\n            return this._bounds;\n        },\n        set: function set(bounds) {\n            this._bounds = bounds;\n            this._adjustCameraToBounds();\n        }\n    }, {\n        key: 'camera',\n        get: function get() {\n            return this._camera;\n        }\n    }, {\n        key: 'scale',\n        get: function get() {\n            return this._scale;\n        }\n\n        /**\r\n         * Map state handles the translation of screen coordinates into world coordinates the bounds are expected to be \r\n         * in right hand coordinates -> lef < right, bottom < top\r\n         * @param {*Rectangle} bounds - bounds of the rectangle that should be shown\r\n         */\n\n    }], [{\n        key: 'ZOOMFACTOR',\n        value: function ZOOMFACTOR() {\n            return 1.1;\n        }\n    }]);\n\n    function MapState(bounds) {\n        _classCallCheck(this, MapState);\n\n        this._bounds = bounds;\n        this._scale = 1;\n        this._camera = new _three.OrthographicCamera(bounds.left, bounds.right, bounds.top, bounds.bottom, 1, 100);\n        this._camera.position.z = 1;\n        this._camera.frustumCulled = false;\n    }\n\n    _createClass(MapState, [{\n        key: 'transformCoordinate',\n        value: function transformCoordinate(offsetX, offsetY) {\n            return {\n                x: offsetX * this._scale + this.bounds.left,\n                y: this.bounds.bottom + this.bounds.height - offsetY * this._scale\n            };\n        }\n    }, {\n        key: 'resizeMap',\n        value: function resizeMap(toWidth, toHeight) {\n\n            this.bounds = _Rectangle.Rectangle.createRectFromCenterDimensions(this.bounds.centerX, this.bounds.centerY, toWidth * this._scale, toHeight * this._scale);\n        }\n    }, {\n        key: 'resizeMapEnclose',\n        value: function resizeMapEnclose(rectangle) {\n            var aspect = this.bounds.width / this.bounds.height;\n            var newBounds = void 0;\n\n            if (rectangle.width > rectangle.height) {\n                newBounds = _Rectangle.Rectangle.createRectFromCenterDimensions(rectangle.centerX, rectangle.centerY, rectangle.width, rectangle.width / aspect);\n            } else {\n                newBounds = _Rectangle.Rectangle.createRectFromCenterDimensions(rectangle.centerX, rectangle.centerY, rectangle.height * aspect, rectangle.height);\n            }\n            this._scale = newBounds.width / this.bounds.width;\n            this.bounds = newBounds;\n        }\n    }, {\n        key: 'moveMap',\n        value: function moveMap(offsetX, offsetY) {\n            this.bounds = _Rectangle.Rectangle.createRectFromOffset(this.bounds, -offsetX * this._scale, -offsetY * this._scale);\n        }\n    }, {\n        key: 'moveMapTo',\n        value: function moveMapTo(centerX, centerY) {\n            this.bounds = _Rectangle.Rectangle.createRectFromCenterDimensions(centerX, centerY, this.bounds.width, this.bounds.height);\n        }\n    }, {\n        key: 'zoomInReCenter',\n        value: function zoomInReCenter(offsetX, offsetY) {\n            this._zoomReCenter(1 / MapState.ZOOMFACTOR(), offsetX, offsetY);\n        }\n    }, {\n        key: 'zoomOutReCenter',\n        value: function zoomOutReCenter(offsetX, offsetY) {\n            this._zoomReCenter(MapState.ZOOMFACTOR(), offsetX, offsetY);\n        }\n    }, {\n        key: '_zoomReCenter',\n        value: function _zoomReCenter(factor, offsetX, offsetY) {\n\n            //1. Translate center\n            //calculate center of zoom\n            var zoomCenterX = offsetX * this._scale + this.bounds.left;\n            var zoomCenterY = this.bounds.bottom + this.bounds.height - offsetY * this._scale;\n\n            this._scale = this._scale * factor;\n\n            //calculate the center of zoom relative to bounds as e.g. offset/width\n            var relativeX = (zoomCenterX - this.bounds.left) / this.bounds.width;\n            var relativeY = (zoomCenterY - this.bounds.bottom) / this.bounds.height;\n\n            //2. zoom\n            var width = this._bounds.width * factor;\n            var height = this._bounds.height * factor;\n\n            //3. Translate back\n            //calculate bounds\n            var left = zoomCenterX - width * relativeX;\n            var right = zoomCenterX + width * (1 - relativeX);\n            var top = zoomCenterY + height * (1 - relativeY);\n            var bottom = zoomCenterY - height * relativeY;\n            this.bounds = new _Rectangle.Rectangle(left, right, top, bottom);\n        }\n    }, {\n        key: '_adjustCameraToBounds',\n        value: function _adjustCameraToBounds() {\n            this._camera.left = this._bounds.left;\n            this._camera.right = this._bounds.right;\n            this._camera.top = this._bounds.top;\n            this._camera.bottom = this._bounds.bottom;\n            this._camera.updateProjectionMatrix();\n        }\n    }]);\n\n    return MapState;\n}();\n\nexports.MapState = MapState;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Http = function () {\n    _createClass(Http, null, [{\n        key: \"URLPATH_NETWORK\",\n        value: function URLPATH_NETWORK() {\n            return \"network\";\n        }\n    }, {\n        key: \"URLPATH_SNAPSHOTS\",\n        value: function URLPATH_SNAPSHOTS() {\n            return \"snapshots\";\n        }\n    }, {\n        key: \"URLPATH_PLAN\",\n        value: function URLPATH_PLAN() {\n            return 'plan';\n        }\n    }, {\n        key: \"URLPATH_CONFIGURATION\",\n        value: function URLPATH_CONFIGURATION() {\n            return \"configuration\";\n        }\n    }, {\n        key: \"STATUS_OK\",\n        value: function STATUS_OK() {\n            return 200;\n        }\n    }, {\n        key: \"RESPONSETYPE_TEXT\",\n        value: function RESPONSETYPE_TEXT() {\n            return 'text';\n        }\n    }, {\n        key: \"RESPONSETYPE_BUFFER\",\n        value: function RESPONSETYPE_BUFFER() {\n            return 'arraybuffer';\n        }\n    }]);\n\n    function Http(dataUrl) {\n        _classCallCheck(this, Http);\n\n        console.log(dataUrl);\n        this._dataUrl = dataUrl;\n    }\n\n    _createClass(Http, [{\n        key: \"getConfigData\",\n        value: function getConfigData(success, error) {\n            var url = this._dataUrl + Http.URLPATH_CONFIGURATION();\n            console.log(url);\n            this.makePostRequest(url, {}, Http.RESPONSETYPE_TEXT(), success, error);\n        }\n    }, {\n        key: \"getNetworkData\",\n        value: function getNetworkData(success, error) {\n            var url = this._dataUrl + Http.URLPATH_NETWORK();\n            this.makePostRequest(url, {}, Http.RESPONSETYPE_BUFFER(), success, error);\n        }\n    }, {\n        key: \"getSnapshotData\",\n        value: function getSnapshotData(parameters, success, error) {\n            var url = this._dataUrl + Http.URLPATH_SNAPSHOTS();\n            this.makePostRequest(url, parameters, Http.RESPONSETYPE_BUFFER(), success, error);\n        }\n    }, {\n        key: \"getPlan\",\n        value: function getPlan(parameters, success, error) {\n            var url = this._dataUrl + Http.URLPATH_PLAN();\n            this.makePostRequest(url, parameters, Http.RESPONSETYPE_TEXT(), success, error);\n        }\n    }, {\n        key: \"makePostRequest\",\n        value: function makePostRequest(url, data, responseType, success, error) {\n            var _this = this;\n\n            console.log(url);\n            console.log('heee');\n            var request = new XMLHttpRequest();\n            request.onreadystatechange = function () {\n                return _this.readyStateChangedHandler(request, success, error);\n            };\n            var dataString = JSON.stringify(data);\n            request.open('POST', url);\n            request.setRequestHeader(\"Content-type\", \"application/JSON\");\n            request.responseType = responseType;\n            request.send(dataString);\n        }\n    }, {\n        key: \"readyStateChangedHandler\",\n        value: function readyStateChangedHandler(request, success, error) {\n            if (Http.isRequestDone(request)) {\n                if (Http.isStatusSuccess(request)) {\n                    success(request.response);\n                } else {\n                    console.log('Error in Webrequest. Code: ' + request.status);\n                    if (error) {\n                        error({ message: 'error in web request', status: request.status });\n                    }\n                }\n            }\n        }\n    }], [{\n        key: \"isRequestDone\",\n        value: function isRequestDone(request) {\n            return request.readyState === XMLHttpRequest.DONE;\n        }\n    }, {\n        key: \"isStatusSuccess\",\n        value: function isStatusSuccess(request) {\n            return request.status === Http.STATUS_OK();\n        }\n    }]);\n\n    return Http;\n}();\n\nexports.Http = Http;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Shader = function () {\n    function Shader() {\n        _classCallCheck(this, Shader);\n    }\n\n    _createClass(Shader, null, [{\n        key: \"interpolatePositionsVertexShader\",\n        value: function interpolatePositionsVertexShader() {\n            return \"\\n                attribute vec3 nextPosition;\\n                attribute float shouldInterpolate;\\n                attribute float id;\\n\\n                uniform float timestepFraction;\\n                uniform float size;\\n                uniform float hitTestThreshold;\\n                uniform float selectedId;\\n\\n                varying float vRotation;\\n                varying float vShouldInterpolate;\\n                varying float vIsSelected;\\n                varying float vIsHover;\\n\\n                vec3 interpolate(in vec3 pos1, in vec3 pos2, in float timestepFraction, in float shouldInterpolate) {\\n                    \\n                    if(shouldInterpolate >= 0.0) {\\n                        vec3 direction = (pos2 - pos1);\\n                        vRotation = atan(direction.x, direction.y);\\n                        return (direction * timestepFraction) + pos1;\\n                    }\\n                    else {\\n                        vRotation = 0.0;\\n                        return pos1;\\n                    }\\n                }\\n\\n                float isIdSelected() {\\n\\n                    float result = 0.0;\\n\\n                    if(selectedId == id) {\\n                        result = 1.0;\\n                    }\\n                    return result;\\n                }\\n\\n                float getSize() {\\n                    float result = 0.0;\\n\\n                    if (vIsSelected >= 1.0) {\\n                        result = size * 3.0;\\n                    } else if (shouldInterpolate < 1.0) {\\n                        result = size * 0.7;\\n                    } else {\\n                        result = size;\\n                    }\\n                    return result;\\n                }\\n\\n                void main() {\\n\\n                    vIsSelected = isIdSelected();\\n\\n                    gl_PointSize = getSize();\\n                    \\n                    vShouldInterpolate = shouldInterpolate;\\n                    vec3 interpolated = interpolate(position, nextPosition, timestepFraction, shouldInterpolate);\\n\\n                    if (vIsSelected >= 1.0) {\\n                        interpolated.z = 1.0;\\n                    }\\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(interpolated, 1.0);\\n                }\\n        \";\n        }\n    }, {\n        key: \"interpolatePositionsFragmentShader\",\n        value: function interpolatePositionsFragmentShader() {\n            return \"\\n                uniform vec3 color;\\n                uniform vec3 selectedColor;\\n                uniform float timestepFraction;\\n\\n                uniform sampler2D triangle;\\n                uniform sampler2D circle;\\n                \\n                varying float vRotation;\\n                varying float vShouldInterpolate;\\n                varying float vIsSelected;\\n                \\n                vec2 rotateCoordinates() {\\n                    mat2 rotationMatrix = mat2(cos(vRotation), sin(vRotation), -sin(vRotation), cos(vRotation));\\n\\n                    vec2 centerBasedCoord = vec2(gl_PointCoord.x -0.5, gl_PointCoord.y - 0.5);\\n                    vec2 centerBasedRotatedCoord = centerBasedCoord * rotationMatrix;\\n                    return centerBasedRotatedCoord + 0.5;\\n                }\\n\\n                vec4 getColor() {\\n                    \\n                    vec4 result;\\n\\n                    if (vIsSelected >= 1.0) {\\n                        result = vec4(selectedColor, 1.0);\\n                    }\\n                    else {\\n                        result = vec4(color, 1.0);\\n                    }\\n                    return result;\\n                }\\n\\n                void main() {\\n\\n                    vec4 opaqueColor = getColor();\\n\\n                    if (vShouldInterpolate >= 1.0) {\\n                        vec2 coord = rotateCoordinates();\\n                        gl_FragColor = opaqueColor * texture2D(triangle, coord);\\n                    } else {\\n                        opaqueColor.a = 1.0 - timestepFraction;\\n                        gl_FragColor = opaqueColor * texture2D(circle, gl_PointCoord);\\n                    }\\n\\n                    if ( gl_FragColor.a < ALPHATEST ) discard;\\n                }\\n        \";\n        }\n    }]);\n\n    return Shader;\n}();\n\nexports.Shader = Shader;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.DrawingController = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Rectangle = __webpack_require__(1);\n\nvar _http = __webpack_require__(7);\n\nvar _Playback = __webpack_require__(4);\n\nvar _MapState = __webpack_require__(6);\n\nvar _MapInteractionController = __webpack_require__(5);\n\nvar _Shader = __webpack_require__(8);\n\nvar _BufferHolder = __webpack_require__(15);\n\nvar _Configuration = __webpack_require__(0);\n\nvar _Configuration2 = _interopRequireDefault(_Configuration);\n\nvar _three = __webpack_require__(2);\n\nvar _triangle = __webpack_require__(18);\n\nvar _triangle2 = _interopRequireDefault(_triangle);\n\nvar _circle = __webpack_require__(16);\n\nvar _circle2 = _interopRequireDefault(_circle);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DrawingController = function () {\n    _createClass(DrawingController, [{\n        key: 'mapState',\n        set: function set(mapState) {\n            this._mapState = mapState;\n            this.resize();\n        },\n        get: function get() {\n            return this._mapState;\n        }\n    }, {\n        key: 'interactionController',\n        set: function set(controller) {\n            var _this = this;\n\n            this._interactionController = controller;\n            controller.clicked = function (p) {\n                return _this.raycast(p);\n            };\n            controller.redrawNeeded = function () {\n                return _this.renderOnce(false);\n            };\n        },\n        get: function get() {\n            return this._interactionController;\n        }\n    }, {\n        key: 'playback',\n        set: function set(value) {\n            this._playback = value;\n        },\n        get: function get() {\n            return this._playback;\n        }\n    }, {\n        key: 'dataProvider',\n        set: function set(dataProvider) {\n            this._dataProvider = dataProvider;\n        },\n        get: function get() {\n            return this._dataProvider;\n        }\n    }], [{\n        key: 'AGENT_LAYER',\n        value: function AGENT_LAYER() {\n            return 'agent-layer';\n        }\n    }, {\n        key: 'NETWORK_LAYER',\n        value: function NETWORK_LAYER() {\n            return 'network-layer';\n        }\n    }]);\n\n    function DrawingController() {\n        _classCallCheck(this, DrawingController);\n\n        this.initialize();\n    }\n\n    _createClass(DrawingController, [{\n        key: 'initialize',\n        value: function initialize() {\n            var _this2 = this;\n\n            this._config = _Configuration2.default.getConfig();\n            this._config.subscribeServerConfigUpdated(function () {\n                return _this2._onServerConfigUpdated();\n            });\n\n            var canvas = document.getElementById(this._config.canvasId);\n            this.renderer = new _three.WebGLRenderer({ canvas: canvas, antialias: true });\n            this.renderer.setPixelRatio(window.devicePixelRatio);\n\n            this._bufferHolder = new _BufferHolder.BufferHolder();\n            this._bufferHolder.redrawNeeded = function () {\n                return _this2.renderOnce(false);\n            };\n            this.mapState = new _MapState.MapState(new _Rectangle.Rectangle(0, 0, 0, 0));\n            this.interactionController = new _MapInteractionController.MapInteractionController(this.mapState);\n            this._raycaster = new _three.Raycaster();\n\n            this.resize();\n            this._boundResize = function (e) {\n                return _this2.resize(e);\n            };\n            window.addEventListener('resize', this._boundResize);\n        }\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n            window.removeEventListener('resize', this._boundResize);\n            this.stopPlayback();\n            this.renderer.dispose();\n            this._interactionController.destroy();\n        }\n    }, {\n        key: '_onServerConfigUpdated',\n        value: function _onServerConfigUpdated() {\n            var _this3 = this;\n\n            var rawBounds = this._config.bounds;\n            var bounds = new _Rectangle.Rectangle(rawBounds.left, rawBounds.right, rawBounds.top, rawBounds.bottom);\n            this.mapState.resizeMapEnclose(bounds);\n            this.dataProvider.networkDataChanged = function (data) {\n                return _this3.onNetworkDataChanged(data);\n            };\n            this.dataProvider.geoJsonDataChanged = function (layerName) {\n                return _this3.onGeoJsonDataChanged(layerName);\n            };\n            this.dataProvider.loadNetworkData();\n        }\n    }, {\n        key: 'onNetworkDataChanged',\n        value: function onNetworkDataChanged(data) {\n            this._bufferHolder.clearNetworkBuffer();\n            this._bufferHolder.loadNetworkBuffer(data);\n            this.renderOnce(false);\n        }\n    }, {\n        key: 'onGeoJsonDataChanged',\n        value: function onGeoJsonDataChanged(layerName) {\n            this._bufferHolder.clearGeoJsonBuffer(layerName);\n            var layer = this.dataProvider.getLayer(layerName);\n            this._bufferHolder.loadGeoJsonBuffer(layer);\n            this.renderOnce(false);\n        }\n    }, {\n        key: 'resize',\n        value: function resize() {\n            var canvas = document.getElementById(this._config.canvasId);\n            var width = canvas.clientWidth;\n            var height = canvas.clientHeight;\n            canvas.width = width * window.devicePixelRatio;\n            canvas.height = height * window.devicePixelRatio;\n\n            this.resizeMap(width, height);\n            this.renderer.setViewport(0, 0, width, height);\n            this.renderOnce(false);\n        }\n    }, {\n        key: 'resizeMap',\n        value: function resizeMap(width, height) {\n\n            if (this.mapState) {\n                if (this.mapState.bounds.width === 0 || this.mapState.bounds.height === 0) {\n                    this.mapState.bounds = new _Rectangle.Rectangle(0, width, 0, height);\n                } else {\n                    this.mapState.resizeMap(width, height);\n                }\n            }\n        }\n    }, {\n        key: 'raycast',\n        value: function raycast(point) {\n\n            if (!this._bufferHolder.hasAgentLayer) return;\n\n            this._raycaster.params.Points.threshold = 10 * this.mapState.scale;\n            var ray = new _three.Vector3(point.x, point.y, 0);\n            this._raycaster.set(ray, new _three.Vector3(0, 0, -1));\n            var agentLayer = this._bufferHolder.getLayer(_BufferHolder.BufferHolder.AGENT_LAYER());\n            var intersects = this._raycaster.intersectObject(agentLayer, false);\n            if (intersects.length > 0) {\n                var idIndex = this.dataProvider.getId(intersects[0].index, this.playback.currentTimestep);\n                this.dataProvider.loadPlan(idIndex);\n                this._bufferHolder.updateAgentBufferUniform('selectedId', idIndex);\n            } else {\n                this._bufferHolder.updateAgentBufferUniform('selectedId', -1);\n                this._bufferHolder.clearGeoJsonBuffer('selectedPlan');\n            }\n            if (!this.shouldRender) this.renderOnce(false);\n        }\n    }, {\n        key: 'startPlayback',\n        value: function startPlayback() {\n            if (!this.shouldRender) {\n                this._bufferHolder.loadAgentBuffer();\n                this.shouldRender = true;\n                this.render();\n            }\n        }\n    }, {\n        key: 'stopPlayback',\n        value: function stopPlayback() {\n            this.shouldRender = false;\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _this4 = this;\n\n            if (!this.shouldRender) return;\n\n            requestAnimationFrame(function () {\n                return _this4.render();\n            });\n            this.renderOnce(true);\n        }\n    }, {\n        key: 'renderOnce',\n        value: function renderOnce(isAnimationFrame) {\n            if (isAnimationFrame) {\n                this.playback.incrementTime();\n                this._animateAgents();\n            }\n            this.renderer.render(this._bufferHolder.scene, this.mapState.camera);\n        }\n    }, {\n        key: '_animateAgents',\n        value: function _animateAgents() {\n\n            if (!this.playback || !this._bufferHolder.hasAgentLayer || !this.shouldRender) {\n                return;\n            }\n\n            if (this.playback.shouldLoadNewSnapshot()) {\n                var snapshot = this.playback.getSnapshotForCurrentTimestep();\n                this._bufferHolder.updateAgentBufferAttribute('position', snapshot.position);\n                this._bufferHolder.updateAgentBufferAttribute('nextPosition', snapshot.nextPosition);\n                this._bufferHolder.updateAgentBufferAttribute('shouldInterpolate', snapshot.shouldInterpolate);\n                this._bufferHolder.updateAgentBufferAttribute('id', snapshot.ids);\n            }\n\n            this._bufferHolder.updateAgentBufferUniform('timestepFraction', this.playback.timestepFraction);\n        }\n    }]);\n\n    return DrawingController;\n}();\n\nexports.DrawingController = DrawingController;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function () {\n\treturn new Worker(__webpack_require__.p + \"b1bc9e47835152906700.worker.js\");\n};\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function () {\n\treturn new Worker(__webpack_require__.p + \"a57fa866e23a9a126393.worker.js\");\n};\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LayerData = function () {\n    _createClass(LayerData, [{\n        key: \"layers\",\n        get: function get() {\n            return this._layers;\n        }\n    }]);\n\n    function LayerData() {\n        _classCallCheck(this, LayerData);\n\n        this._layers = [];\n    }\n\n    _createClass(LayerData, [{\n        key: \"addLayer\",\n        value: function addLayer(layer) {\n\n            //check whether a layer with the name exists\n            var foundIndex = -1;\n            var foundLayer = this._layers.find(function (entry, index) {\n                if (entry.name === layer.name) {\n                    foundIndex = index;\n                    return true;\n                }\n            });\n\n            if (foundIndex >= 0) {\n                this._layers.splice(foundIndex, 1, layer);\n            } else {\n                this._layers.push(layer);\n            }\n        }\n    }, {\n        key: \"removeLayer\",\n        value: function removeLayer(layerName) {\n            var foundIndex = -1;\n            this._layers.find(function (entry, index) {\n                if (entry.name === layerName) {\n                    foundIndex = index;\n                    return true;\n                }\n            });\n\n            if (foundIndex >= 0) {\n                this._layers.splice(foundIndex, 1);\n            }\n        }\n    }, {\n        key: \"getLayer\",\n        value: function getLayer(layerName) {\n            var layer = this._layers.find(function (entry) {\n                return layerName === entry.name;\n            });\n            return layer;\n        }\n    }], [{\n        key: \"createLayer\",\n        value: function createLayer(name, z, color, data) {\n            return {\n                name: name,\n                z: z,\n                color: color,\n                points: data.points,\n                lines: data.lines,\n                shapeVertices: data.shapeVertices,\n                shapeNormals: data.shapeNormals\n            };\n        }\n    }]);\n\n    return LayerData;\n}();\n\nexports.LayerData = LayerData;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SnapshotData = function () {\n    _createClass(SnapshotData, [{\n        key: 'firstTimestep',\n        get: function get() {\n            if (this._hasSnapshots()) {\n                return this.snapshots[0].time;\n            }\n            return 0;\n        }\n    }, {\n        key: 'lastTimestep',\n        get: function get() {\n            if (this._hasSnapshots()) {\n                return this.snapshots[this.snapshots.length - 1].time;\n            }\n            return 0;\n        }\n    }]);\n\n    function SnapshotData(timestepSize) {\n        _classCallCheck(this, SnapshotData);\n\n        this.timestepSize = timestepSize;\n        this.snapshots = new Array();\n    }\n\n    _createClass(SnapshotData, [{\n        key: 'addSnapshotsAndForgetOldOnes',\n        value: function addSnapshotsAndForgetOldOnes(data, smallestTimestepToKeepCached, speedFactor) {\n\n            //there was a jump in on the timeline, so all cached snapshots can be deleted\n            if (this.snapshots.length == 0 || smallestTimestepToKeepCached > this.lastTimestep) {\n                this.snapshots = data;\n            }\n            //otherwise we can forget older snapshots and append the newly loaded snapshots\n            else if (data.length > 0) {\n                    var firstTimestepToAppend = data[0].time;\n                    var indexToKeep = this._getIndexForTimestep(smallestTimestepToKeepCached, speedFactor);\n                    var dataToAppend = void 0;\n\n                    if (!this._canTimestepBeAppended(firstTimestepToAppend)) {\n                        dataToAppend = this._makeSnapshotsAppendable(data);\n                    } else {\n                        dataToAppend = data;\n                    }\n\n                    if (dataToAppend) {\n                        //remove the last snaphot, since we'll get a new one\n                        this.snapshots.splice(this.snapshots.length - 1, 1);\n\n                        //get rid of old snapshots and concatenate the new ones\n                        this.snapshots = this.snapshots.slice(indexToKeep).concat(data);\n                    } else {\n                        throw new Error('new Data didn\"t fit lastTimestep: ' + this.lastTimestep + ' first new timestep: ' + firstTimestepToAppend);\n                    }\n                }\n        }\n    }, {\n        key: 'getSnapshot',\n        value: function getSnapshot(timestep, speedFactor) {\n            //ensure timeststep is within bounds\n            if (this.firstTimestep - 0.0001 > timestep || this.lastTimestep + 0.0001 < timestep) {\n                throw new RangeError('timestep: ' + timestep + ' was not within chached timespan');\n            }\n\n            if (speedFactor < 1.0) {\n                throw new RangeError('speedFactor must not be smaller than 1.0 but was: ' + speedFactor);\n            }\n            //calculate index\n            var index = this._getIndexForTimestep(timestep, speedFactor);\n            return this.snapshots[Math.floor(index)];\n        }\n    }, {\n        key: 'hasSnapshotFor',\n        value: function hasSnapshotFor(timestep) {\n            return this.firstTimestep <= timestep && this.lastTimestep >= timestep;\n        }\n    }, {\n        key: 'clearSnapshots',\n        value: function clearSnapshots() {\n            this.snapshots = [];\n        }\n    }, {\n        key: '_getIndexForTimestep',\n        value: function _getIndexForTimestep(timestep, speedFactor) {\n            var index = (timestep - this.firstTimestep) / this.timestepSize / speedFactor;\n\n            if (index < 0) {\n                index = 0;\n            }\n            return index;\n        }\n    }, {\n        key: '_canTimestepBeAppended',\n        value: function _canTimestepBeAppended(timestep) {\n            //timestep must be the same as last timestep\n            return this.lastTimestep + 0.0001 > timestep && this.lastTimestep - 0.0001 < timestep;\n        }\n    }, {\n        key: '_makeSnapshotsAppendable',\n        value: function _makeSnapshotsAppendable(data) {\n            for (var i = 0; i < data.length; i++) {\n                if (this._canTimestepBeAppended(data[i].time)) {\n                    return data.slice(i);\n                }\n            }\n            return undefined;\n        }\n    }, {\n        key: '_hasSnapshots',\n        value: function _hasSnapshots() {\n            return this.snapshots.length > 0;\n        }\n    }]);\n\n    return SnapshotData;\n}();\n\nexports.SnapshotData = SnapshotData;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar WorkerFacade = function () {\n    function WorkerFacade(worker, eventCallback) {\n        var _this = this;\n\n        _classCallCheck(this, WorkerFacade);\n\n        if (worker) {\n            this.worker = new worker();\n            this.boundHandelWorkerMessage = function (e) {\n                return _this.handleWorkerMessage(e);\n            };\n            this.worker.addEventListener('message', this.boundHandelWorkerMessage);\n            this.eventCallback = eventCallback;\n        }\n    }\n\n    _createClass(WorkerFacade, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.worker) {\n                this.worker.removeEventListener('message', this.boundHandelWorkerMessage);\n                this.worker.terminate();\n            }\n        }\n    }, {\n        key: 'handleWorkerMessage',\n        value: function handleWorkerMessage(e) {\n            var then = Date.now();\n            var data = e.data;\n\n            switch (data.type) {\n                case 'error':\n                    console.error('Error in Web-Worker: ' + data.message);\n                    break;\n                case 'log':\n                    console.log('Info Web-Worker: ' + data.message);\n                    break;\n                case 'event':\n                    this.onWorkerEvent(data.name, data.data);\n                    break;\n                default:\n                    this.onWorkerMessageReceived(data);\n            }\n            var time = Date.now() - then;\n            if (data.name) {\n                console.log('handle WorkerMessage \"' + data.name + '\" took: ' + time + 'ms');\n            }\n        }\n    }, {\n        key: 'onWorkerMessageReceived',\n        value: function onWorkerMessageReceived(data) {\n            //nothing: subclasses can override this method\n            console.error('PlaybackController._handleWorkerMessage: Error! receivd unknown message type');\n        }\n    }, {\n        key: 'onWorkerEvent',\n        value: function onWorkerEvent(name, data) {\n            this.eventCallback(name, data);\n        }\n    }, {\n        key: 'postWorkerMessage',\n        value: function postWorkerMessage(methodName, parameters) {\n            if (this.worker) {\n                this.worker.postMessage({ method: methodName, parameters: parameters });\n            }\n        }\n    }, {\n        key: 'postWorkerMessage',\n        value: function postWorkerMessage(methodName, data, transferrables) {\n            if (this.worker) {\n                var obj = {\n                    method: methodName,\n                    parameters: data\n                };\n                this.worker.postMessage(obj, transferrables);\n            }\n        }\n    }]);\n\n    return WorkerFacade;\n}();\n\nexports.WorkerFacade = WorkerFacade;\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.BufferHolder = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _three = __webpack_require__(2);\n\nvar _Shader = __webpack_require__(8);\n\nvar _Configuration = __webpack_require__(0);\n\nvar _Configuration2 = _interopRequireDefault(_Configuration);\n\nvar _triangle = __webpack_require__(19);\n\nvar _triangle2 = _interopRequireDefault(_triangle);\n\nvar _circle = __webpack_require__(17);\n\nvar _circle2 = _interopRequireDefault(_circle);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar BufferHolder = function () {\n    _createClass(BufferHolder, [{\n        key: 'scene',\n        get: function get() {\n            return this._scene;\n        }\n    }, {\n        key: 'hasAgentLayer',\n        get: function get() {\n            return this._hasLayer(BufferHolder.AGENT_LAYER());\n        }\n    }, {\n        key: 'redrawNeeded',\n        set: function set(callback) {\n            this._redrawNeeded = callback;\n        }\n    }], [{\n        key: 'AGENT_LAYER',\n        value: function AGENT_LAYER() {\n            return 'agent-layer';\n        }\n    }, {\n        key: 'NETWORK_LAYER',\n        value: function NETWORK_LAYER() {\n            return 'network-layer';\n        }\n    }]);\n\n    function BufferHolder() {\n        _classCallCheck(this, BufferHolder);\n\n        this._config = _Configuration2.default.getConfig();\n        this._scene = new _three.Scene();\n        this._scene.background = new _three.Color(this._config.colors.background);\n    }\n\n    _createClass(BufferHolder, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._redrawNeeded = null;\n            this._scene = null;\n        }\n    }, {\n        key: 'clearNetworkBuffer',\n        value: function clearNetworkBuffer() {\n            this._clearBuffer(BufferHolder.NETWORK_LAYER());\n        }\n    }, {\n        key: 'clearAgentBuffer',\n        value: function clearAgentBuffer() {\n            this._clearBuffer(BufferHolder.AGENT_LAYER());\n        }\n    }, {\n        key: 'clearGeoJsonBuffer',\n        value: function clearGeoJsonBuffer(layerName) {\n            this._clearBuffer('p' + layerName);\n            this._clearBuffer('l' + layerName);\n            this._clearBuffer('s' + layerName);\n        }\n    }, {\n        key: '_clearBuffer',\n        value: function _clearBuffer(layerName) {\n            if (this._scene.children) {\n                var layer = this._scene.getObjectByName(layerName);\n                this.scene.remove(layer);\n            }\n        }\n    }, {\n        key: 'loadNetworkBuffer',\n        value: function loadNetworkBuffer(links) {\n            if (!this._hasLayer(BufferHolder.NETWORK_LAYER())) {\n                var lines = this._createLineMesh(BufferHolder.NETWORK_LAYER(), links, -11, this._config.colors.network);\n                this._scene.add(lines);\n            }\n        }\n    }, {\n        key: 'loadAgentBuffer',\n        value: function loadAgentBuffer() {\n\n            if (this._hasLayer(BufferHolder.AGENT_LAYER())) return;\n\n            var shaderMaterial = new _three.ShaderMaterial({\n                vertexShader: _Shader.Shader.interpolatePositionsVertexShader(),\n                fragmentShader: _Shader.Shader.interpolatePositionsFragmentShader(),\n                uniforms: {\n                    timestepFraction: { value: 0.0 },\n                    size: { value: 10.0 * window.devicePixelRatio },\n                    hitTestThreshold: { value: 100.0 },\n                    selectedId: { value: -1 },\n                    mousePosition: { value: new _three.Vector2(0, 0) },\n\n                    color: { value: new _three.Color(this._config.colors.agents) },\n                    selectedColor: { value: new _three.Color(this._config.colors.selectedAgent) },\n                    triangle: { value: this._createTexture(_triangle2.default) },\n                    circle: { value: this._createTexture(_circle2.default) }\n                },\n                transparent: true,\n                alphaTest: 0.1\n            });\n            var points = new _three.Points(new _three.BufferGeometry(), shaderMaterial);\n            points.name = BufferHolder.AGENT_LAYER();\n            points.frustumCulled = false;\n            points.position.z = -10;\n            this._scene.add(points);\n\n            this._createAgentBufferAttribute('position', 3);\n            this._createAgentBufferAttribute('nextPosition', 3);\n            this._createAgentBufferAttribute('shouldInterpolate', 1);\n            this._createAgentBufferAttribute('id', 1);\n        }\n    }, {\n        key: 'loadGeoJsonBuffer',\n        value: function loadGeoJsonBuffer(layer) {\n\n            if (!layer) return;\n\n            if (layer.points && layer.points.length > 0) {\n                var points = this._createPointsMesh('p' + layer.name, layer.points, layer.z, 16, layer.color, _circle2.default);\n                this._scene.add(points);\n            }\n\n            if (layer.lines && layer.lines.length > 0) {\n                var lines = this._createLineMesh('l' + layer.name, layer.lines, layer.z, layer.color);\n                this._scene.add(lines);\n            }\n            if (layer.shapeVertices && layer.shapeVertices.length > 0 && layer.shapeNormals && layer.shapeNormals.length == layer.shapeVertices.length) {\n                var shapes = this._createShapeMesh('s' + layer.name, layer.shapeVertices, layer.shapeNormals, layer.z, layer.color);\n                this._scene.add(shapes);\n            }\n        }\n    }, {\n        key: '_createAgentBufferAttribute',\n        value: function _createAgentBufferAttribute(name, itemSize) {\n            var attribute = new _three.BufferAttribute(new Float32Array([]), itemSize);\n            var agentLayer = this._scene.getObjectByName(BufferHolder.AGENT_LAYER());\n            agentLayer.geometry.addAttribute(name, attribute);\n        }\n    }, {\n        key: 'updateAgentBufferAttribute',\n        value: function updateAgentBufferAttribute(name, array) {\n            var agentLayer = this._scene.getObjectByName(BufferHolder.AGENT_LAYER());\n            var attribute = agentLayer.geometry.getAttribute(name);\n            attribute.setArray(array);\n            attribute.needsUpdate = true;\n        }\n    }, {\n        key: 'updateAgentBufferUniform',\n        value: function updateAgentBufferUniform(name, value) {\n            var agentLayer = this._scene.getObjectByName(BufferHolder.AGENT_LAYER());\n            agentLayer.material.uniforms[name].value = value;\n        }\n    }, {\n        key: 'getLayer',\n        value: function getLayer(layerName) {\n            return this._scene.getObjectByName(layerName);\n        }\n    }, {\n        key: '_createLineMesh',\n        value: function _createLineMesh(name, lines, z, color) {\n            var material = new _three.LineBasicMaterial({ color: color });\n            var geometry = this._createBufferGeometry(lines);\n            var mesh = new _three.LineSegments(geometry, material);\n            this._setMeshProperties(mesh, name, z);\n            return mesh;\n        }\n    }, {\n        key: '_createPointsMesh',\n        value: function _createPointsMesh(name, points, z, size, color, image) {\n            var material = new _three.PointsMaterial({ color: color, sizeAttenuation: false, size: size });\n\n            if (image) {\n                material.map = this._createTexture(image, this._redrawNeeded);\n                material.alphaTest = 0.9;\n            }\n            var geometry = this._createBufferGeometry(points);\n            var mesh = new _three.Points(geometry, material);\n            this._setMeshProperties(mesh, name, z);\n            return mesh;\n        }\n    }, {\n        key: '_createShapeMesh',\n        value: function _createShapeMesh(name, vertices, normals, z, color) {\n            var material = new _three.MeshBasicMaterial({ color: color });\n            var geometry = this._createBufferGeometry(vertices);\n            geometry.addAttribute('normal', new _three.BufferAttribute(normals, 3));\n            var mesh = new _three.Mesh(geometry, material);\n            mesh.name = name;\n            mesh.position.z = z;\n            return mesh;\n        }\n    }, {\n        key: '_createBufferGeometry',\n        value: function _createBufferGeometry(positions) {\n            var attribute = new _three.BufferAttribute(positions, 3);\n            var geometry = new _three.BufferGeometry();\n            geometry.addAttribute('position', attribute);\n            geometry.verticesNeedUpdate = true;\n            return geometry;\n        }\n    }, {\n        key: '_createTexture',\n        value: function _createTexture(image, callback) {\n\n            var texture = void 0;\n\n            if (callback) {\n                texture = new _three.TextureLoader().load(image, function (t) {\n                    return callback();\n                });\n            } else {\n                texture = new _three.TextureLoader().load(image);\n            }\n\n            texture.flipY = false;\n            texture.magFilter = _three.NearestFilter;\n            texture.minFilter = _three.NearestFilter;\n            return texture;\n        }\n    }, {\n        key: '_setMeshProperties',\n        value: function _setMeshProperties(mesh, name, z) {\n            mesh.name = name;\n            mesh.position.z = z;\n            mesh.frustumCulled = false;\n        }\n    }, {\n        key: '_hasLayer',\n        value: function _hasLayer(name) {\n            if (this._scene.getObjectByName(name)) {\n                return true;\n            } else return false;\n        }\n    }]);\n\n    return BufferHolder;\n}();\n\nexports.BufferHolder = BufferHolder;\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"be4a969e74158efbd26dd90fdfcbb43e.png\";\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"420d5510d0798b6c420a170b065a987c.png\";\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"9a89ebcac8efafb00dbc7cb521823273.png\";\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"d9243fe8aeba146dee38d93f7dcbc66d.png\";\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Webvis = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _DrawingController = __webpack_require__(9);\n\nvar _Playback = __webpack_require__(4);\n\nvar _DataProvider = __webpack_require__(3);\n\nvar _MapInteractionController = __webpack_require__(5);\n\nvar _MapState = __webpack_require__(6);\n\nvar _Rectangle = __webpack_require__(1);\n\nvar _Configuration = __webpack_require__(0);\n\nvar _Configuration2 = _interopRequireDefault(_Configuration);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Webvis = function () {\n    _createClass(Webvis, [{\n        key: 'firstTimestep',\n        get: function get() {\n            return this._config.firstTimestep;\n        }\n    }, {\n        key: 'lastTimestep',\n        get: function get() {\n            return this._config.lastTimestep;\n        }\n    }, {\n        key: 'timestepSize',\n        get: function get() {\n            return this._config.timestepSize;\n        }\n    }, {\n        key: 'playbackSpeedFactor',\n        get: function get() {\n            return this.playback.speedFactor;\n        }\n    }, {\n        key: 'onServerConfigChanged',\n        set: function set(value) {\n            this._onServerConfigChanged = value;\n        }\n    }, {\n        key: 'onTimestepChanged',\n        set: function set(value) {\n            this.playback.onTimestepChanged = value;\n        }\n    }, {\n        key: 'onFetchingData',\n        set: function set(value) {\n            this._onFetchingData = value;\n        }\n\n        /**\r\n         * Constructor for the webvis Wrapper. It loads everything necessary for starting a Matsim visualization\r\n         * Call this constructor only after \"DOMContentLoaded\" event!\r\n         * @param {object} configuration - A configuration Object with a lot of stuff inside\r\n         */\n\n    }]);\n\n    function Webvis(configParameters) {\n        var _this = this;\n\n        _classCallCheck(this, Webvis);\n\n        _Configuration2.default.createConfiguration(configParameters);\n        this._config = _Configuration2.default.getConfig();\n        this._config.subscribeServerConfigUpdated(function () {\n            return _this._handleServerConfigChanged();\n        });\n        this.dataProvider = new _DataProvider.DataProvider();\n        this.dataProvider.loadServerConfig();\n        this.dataProvider.isFetchingDataChanged = function () {\n            return _this._handleIsFetchingDataChanged();\n        };\n\n        this.drawingController = new _DrawingController.DrawingController();\n        this.drawingController.dataProvider = this.dataProvider;\n\n        this.playback = new _Playback.Playback(this.dataProvider);\n        this.drawingController.playback = this.playback;\n    }\n\n    /**\r\n     * Starts playback of the qSim from current Timestep\r\n     */\n\n\n    _createClass(Webvis, [{\n        key: 'startPlayback',\n        value: function startPlayback() {\n            this.drawingController.startPlayback();\n        }\n\n        /**\r\n         * Stops playback of the qSim\r\n         */\n\n    }, {\n        key: 'stopPlayback',\n        value: function stopPlayback() {\n            this.drawingController.stopPlayback();\n        }\n\n        /**\r\n         * Sets the timestep of the playback to the provided timestep\r\n         * @param {number} timestep - Timesteps for the next frame, should be between last and first timestep\r\n         */\n\n    }, {\n        key: 'seekTimestep',\n        value: function seekTimestep(timestep) {\n            this.playback.seekTimestep(timestep);\n        }\n\n        /**\r\n         * Sets the speed of the playback. Simple speed is multiplied by the provided factor.\r\n         * If factor is e.g. 2.0 every other frame is skipped, thus the animation runs twice as fast\r\n         * @param {number} factor - The playback speed is multiplied by the supplied factor\r\n         */\n\n    }, {\n        key: 'setPlaybackSpeed',\n        value: function setPlaybackSpeed(factor) {\n            this.playback.speedFactor = factor;\n        }\n    }, {\n        key: 'addGeoJsonLayer',\n        value: function addGeoJsonLayer(geoJson, layerName, z, color) {\n            this.dataProvider.addGeoJsonLayer(geoJson, layerName, -z, color);\n        }\n    }, {\n        key: 'removeGeoJsonLayer',\n        value: function removeGeoJsonLayer(layerName) {\n            this.dataProvider.removeGeoJsonLayer(layerName);\n        }\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n\n            //kill all members\n            this.dataProvider.destroy();\n            this.drawingController.destroy();\n            this.playback.destroy();\n            this._config.destroy();\n\n            //remove all delegates\n            this._onFetchingData = null;\n            this._onServerConfigChanged = null;\n        }\n    }, {\n        key: '_handleServerConfigChanged',\n        value: function _handleServerConfigChanged() {\n            if (this._onServerConfigChanged) {\n                this._onServerConfigChanged();\n            }\n        }\n    }, {\n        key: '_handleIsFetchingDataChanged',\n        value: function _handleIsFetchingDataChanged() {\n            if (this._onFetchingData) {\n                this._onFetchingData(this.dataProvider.isFetchingData);\n            }\n        }\n    }]);\n\n    return Webvis;\n}();\n\nexports.Webvis = Webvis;\n\n/***/ })\n],[20]);\n\n\n// WEBPACK FOOTER //\n// webvis.js","\r\n\r\nclass Config {\r\n\r\n    constructor(parameters) {\r\n        this._setCanvasId(parameters.canvasId);\r\n        this._setColors(parameters.colors);\r\n        this._setBackendUrl(parameters.dataUrl);\r\n        this._setCache(parameters.cache);\r\n        this._listeners = [];\r\n    }\r\n\r\n    destroy() {\r\n        this._listeners = null;\r\n    }\r\n\r\n    subscribeServerConfigUpdated(callback) {\r\n        this._listeners.push(callback);\r\n    }\r\n\r\n    unsubscribeServerConfigUpdated(callback) {\r\n        let index = this._listeners.indexOf(callback);\r\n        this._listeners.splice(index, 1);\r\n    }\r\n\r\n    _broadCastServerConfigUpdated() {\r\n        for (let i = 0; i < this._listeners.length; i++) {\r\n            this._listeners[i]();\r\n        }\r\n    }\r\n\r\n    _setCanvasId(id) {\r\n        this.canvasId = id ? id : 'canvas';\r\n    }\r\n\r\n    _setColors(colors) {\r\n        if (!colors) {\r\n            colors = {};\r\n        }\r\n\r\n        this.colors = {\r\n            background: colors.background ? colors.background : 0xECF0F1,\r\n            network: colors.network ? colors.network : 0x2C3E50,\r\n            agents: colors.agents ? colors.agents : 0x3498DB,\r\n            selectedAgent: colors.selectedAgent ? colors.selectedAgent : 0xE74C3C,\r\n            selectedPlan: colors.selectedPlan ? colors.selectedPlan : 0xE74C3C,\r\n        };\r\n    }\r\n\r\n    _setBackendUrl(url) {\r\n        this.dataUrl = url ? url : 'http://localhost:3001/';\r\n    }\r\n\r\n    _setCache(cache) {\r\n        if (!cache) {\r\n            cache = {};\r\n        }\r\n        this.cache = {\r\n            cachedSnapshots: cache.cachedSnapshots ? cache.cachedSnapshots : 1200,\r\n            minRequestSize: cache.minRequestSize ? cache.minRequestSize : 100,\r\n            oldSnapshotsToKeep: cache.oldSnapshotsToKeep ? cache.oldSnapshotsToKeep : 900,\r\n        }\r\n    }\r\n\r\n    _updateServerConfig(parameters) {\r\n        this.firstTimestep = parameters.firstTimestep;\r\n        this.lastTimestep = parameters.lastTimestep;\r\n        this.timestepSize = parameters.timestepSize;\r\n        this.bounds = parameters.bounds;\r\n        this._broadCastServerConfigUpdated();\r\n    }\r\n}\r\n\r\n\r\nlet instance;\r\n\r\nlet Configuration = {\r\n    createConfiguration: (parameters) => {\r\n        instance = new Config(parameters);\r\n    },\r\n\r\n    updateServerConfiguration: (parameters) => {\r\n        instance._updateServerConfig(parameters);\r\n    },\r\n\r\n    getConfig: () => {\r\n        if (!instance) {\r\n            throw Error('configuration was not created yet');\r\n        }\r\n        return instance;\r\n    }\r\n\r\n};\r\n\r\nexport default Configuration;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/contracts/Configuration.js","class Rectangle {\r\n\r\n    get left() {\r\n        return this._left;\r\n    }\r\n\r\n    get right() {\r\n        return this._right;\r\n    }\r\n\r\n    get top() {\r\n        return this._top;\r\n    }\r\n\r\n    get bottom() {\r\n        return this._bottom;\r\n    }\r\n\r\n    get width() {\r\n        return Math.abs(this._right - this._left);\r\n    }\r\n\r\n    get height() {\r\n        return Math.abs(this._bottom - this._top);\r\n    }\r\n\r\n    get centerX() {\r\n        return (this.left + this.right) / 2;\r\n    }\r\n\r\n    get centerY() {\r\n        return (this.top + this.bottom) / 2;\r\n    }\r\n\r\n    constructor(left, right, top, bottom) {\r\n        this._left = left,\r\n        this._right = right;\r\n        this._top = top;\r\n        this._bottom = bottom;\r\n    }\r\n\r\n    static createRectFromCenterDimensions(centerX, centerY, width, height) {\r\n        let left = centerX - width / 2;\r\n        let right = centerX + width / 2\r\n        let top = centerY + height / 2;\r\n        let bottom = centerY - height / 2;\r\n        return new Rectangle(left, right, top, bottom);\r\n    }\r\n\r\n    static createRectFromOffset(rectangle, offsetX, offsetY) {\r\n        let left = rectangle.left + offsetX;\r\n        let right = rectangle.right + offsetX;\r\n        let top = rectangle.top + offsetY;\r\n        let bottom = rectangle.bottom + offsetY;\r\n        return new Rectangle(left, right, top, bottom);\r\n    }\r\n\r\n    static createRectVerticallyFlipped(rectangle) {\r\n        return new Rectangle(\r\n            rectangle.left, rectangle.right,\r\n            -rectangle.top, -rectangle.bottom\r\n        );\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            left: this._left,\r\n            right: this._right,\r\n            top: this._top,\r\n            bottom: this._bottom\r\n        };\r\n    }\r\n}\r\n\r\nexport { Rectangle }\n\n\n// WEBPACK FOOTER //\n// ./src/contracts/Rectangle.js","import { WorkerFacade } from './background/WorkerFacade.js';\r\nimport DataFetcher from './background/DataFetcher.worker.js';\r\nimport GeoJsonParser from './background/GeoJsonParser.worker.js';\r\nimport { SnapshotData } from './SnapshotData.js';\r\nimport { LayerData } from './LayerData.js';\r\nimport { Rectangle } from '../contracts/Rectangle.js';\r\nimport { Http } from '../communication/http.js';\r\nimport Configuration from '../contracts/Configuration.js';\r\n\r\nclass DataProvider {\r\n\r\n    get isFetchingData() { return this._agentRequests >= this._maxConcurrentSnapshotRequests || this._isLoadingPlan; }\r\n\r\n    get lastCachedTimestep() {\r\n        return this.snapshotData.lastTimestep;\r\n    }\r\n\r\n    get firstCachedTimestep() {\r\n        return this.snapshotData.firstTimestep;\r\n    }\r\n\r\n    set networkDataChanged(callback) {\r\n        this._networkDataChanged = callback;\r\n    }\r\n\r\n    set geoJsonDataChanged(callback) {\r\n        this._geoJsonDataChanged = callback;\r\n    }\r\n\r\n    set isFetchingDataChanged(callback) {\r\n        this._isFetchingDataChanged = callback;\r\n    }\r\n\r\n    set speedFactor(value) {\r\n\r\n        if (value >= 1.0)\r\n            this._speedFactor = value;\r\n        else\r\n            this._speedFactor = 1.0;\r\n    }\r\n\r\n    constructor() {\r\n        this._config = Configuration.getConfig();\r\n        this._speedFactor = 1.0;\r\n        this._agentRequests = 0;\r\n        this._requestNumber = 0;\r\n        this._isLoadingPlan = false;\r\n        this._maxConcurrentSnapshotRequests = 1;\r\n        this.workerFacade = new WorkerFacade(DataFetcher, (name, data) => this.onWorkerEvent(name, data));\r\n        this.layerData = new LayerData();\r\n    }\r\n\r\n    destroy() {\r\n        this.workerFacade.destroy();\r\n        if (this._parserWorkerFacade) {\r\n            this._parserWorkerFacade.destroy();\r\n        }\r\n        this.snapshotData = null;\r\n        this.layerData = null;\r\n        this._networkDataChanged = null;\r\n        this._geoJsonDataChanged = null;\r\n        this._isFetchingDataChanged = null;\r\n    }\r\n\r\n    loadServerConfig() {\r\n        this.workerFacade.postWorkerMessage('initialize', { dataUrl: this._config.dataUrl });\r\n        this.workerFacade.postWorkerMessage('getConfig', { id: 'id' });\r\n    }\r\n\r\n    loadNetworkData() {\r\n        this.workerFacade.postWorkerMessage('getNetworkData', {});\r\n    }\r\n\r\n    loadPlan(id) {\r\n\r\n        let params = {\r\n            idIndex: id,\r\n        };\r\n        this.workerFacade.postWorkerMessage('getPlan', params);\r\n        this._isLoadingPlan = true;\r\n        this._onFetchingDataChanged();\r\n    }\r\n\r\n    getId(index, timestep) {\r\n        let snapshot = this.snapshotData.getSnapshot(timestep, this._speedFactor);\r\n        return snapshot.ids[index];\r\n    }\r\n\r\n    getSnapshot(timestep) {\r\n\r\n        this.lastRequestedTimestep = timestep;\r\n        let result;\r\n        //1. Get snapshot from chache if available\r\n        if (this.snapshotData.hasSnapshotFor(timestep)) {\r\n            result = this.snapshotData.getSnapshot(timestep, this._speedFactor);\r\n        }\r\n        else {\r\n            result = {};\r\n        }\r\n\r\n        //2. Make sure there are enough snapshots chached\r\n        //if not tell background worker to load more snapshots\r\n        let lastCachedTimestep = this.snapshotData.lastTimestep;\r\n\r\n        if (this._isSmallerThanLastTimestep(lastCachedTimestep) && !this._isBufferSuficient(timestep)) {\r\n\r\n            let fromTimestep;\r\n            if (lastCachedTimestep < timestep) {\r\n                fromTimestep = timestep;\r\n            } else {\r\n                fromTimestep = lastCachedTimestep;\r\n            }\r\n\r\n            this._loadSnapshots(fromTimestep);\r\n        }\r\n\r\n        //3. return the snapshot or empty object\r\n        return result;\r\n    }\r\n\r\n    addGeoJsonLayer(geoJson, layerName, z, color) {\r\n        let parameters = {\r\n            layerName: layerName,\r\n            z: z,\r\n            color: color,\r\n            geoJson: geoJson\r\n        }\r\n        this._parserWorkerFacade = new WorkerFacade(GeoJsonParser, (name, data) => this.onWorkerEvent(name, data));\r\n        this._parserWorkerFacade.postWorkerMessage('initialize', {});\r\n        this._parserWorkerFacade.postWorkerMessage('parseGeoJson', parameters);\r\n    }\r\n\r\n    removeGeoJsonLayer(layerName) {\r\n        this.layerData.removeLayer(layerName);\r\n        this._geoJsonDataChanged(layerName);\r\n    }\r\n\r\n    getLayer(layerName) {\r\n        return this.layerData.getLayer(layerName);\r\n    }\r\n\r\n    clearCache() {\r\n        this.snapshotData.clearSnapshots();\r\n\r\n        //we also need to reload new agents\r\n        if (this.isFetchingData) {\r\n            this._maxConcurrentSnapshotRequests++;\r\n        }\r\n    }\r\n\r\n    _loadSnapshots(fromTimestep) {\r\n        if (this.isFetchingData) return;\r\n\r\n        this._requestNumber++;\r\n        let requestSize = this._getRequestSize(fromTimestep);\r\n\r\n        let params = {\r\n            requestNumber: this._requestNumber,\r\n            requestParameters: {\r\n                fromTimestep: fromTimestep,\r\n                speedFactor: this._speedFactor,\r\n                size: requestSize,\r\n                bounds: new Rectangle(1, 1, 1, 1)\r\n            }\r\n        }\r\n        this._agentRequests++;\r\n        this.workerFacade.postWorkerMessage('getSnapshotData', params);\r\n        this._onFetchingDataChanged();\r\n    }\r\n\r\n    _handleSnapshotDataReceived(response) {\r\n\r\n        if (response.requestNumber === this._requestNumber) {\r\n            let smallestSnapshotToKeep = this.lastRequestedTimestep;\r\n\r\n            if (smallestSnapshotToKeep < this.snapshotData.lastTimestep) {\r\n                smallestSnapshotToKeep = this.lastRequestedTimestep - (this._config.cache.oldSnapshotsToKeep * this._config.timestepSize);\r\n            }\r\n            this.snapshotData.addSnapshotsAndForgetOldOnes(response.data, smallestSnapshotToKeep, this._speedFactor);\r\n        }\r\n        else {\r\n            this._maxConcurrentSnapshotRequests--;\r\n            console.log('ignore received snapshot since it is outdated');\r\n        }\r\n        this._agentRequests--;\r\n        this._onFetchingDataChanged();\r\n    }\r\n\r\n    _handleConfigDataReceived(data) {\r\n        Configuration.updateServerConfiguration(data);\r\n        this.snapshotData = new SnapshotData(data.timestepSize);\r\n        this.lastTimestep = data.lastTimestep;\r\n        this.firstTimestep = data.firstTimestep;\r\n    }\r\n\r\n    _handlePlanDataReceived(data) {\r\n        this._isLoadingPlan = false;\r\n        let name = 'selectedPlan'\r\n        let layer = LayerData.createLayer(name, -9.0, this._config.colors.selectedPlan, data);\r\n        this.layerData.addLayer(layer);\r\n        this._onFetchingDataChanged();\r\n        this._geoJsonDataChanged(name);\r\n    }\r\n\r\n    _handleGeoJsonParsed(data) {\r\n        let layer = LayerData.createLayer(data.layerName, data.z, data.color, data);\r\n        this.layerData.addLayer(layer);\r\n        this._geoJsonDataChanged(layer.name);\r\n    }\r\n\r\n    _isBufferSuficient(timestep) {\r\n        return this._numberOfCachedTimestepsAhead(timestep) > this._config.cache.cachedSnapshots;\r\n    }\r\n\r\n    _numberOfCachedTimestepsAhead(timestep) {\r\n        return (this.snapshotData.lastTimestep - timestep) / this.snapshotData.timestepSize;\r\n    }\r\n\r\n    _isSmallerThanLastTimestep(timestep) {\r\n        return timestep + this.snapshotData.timestepSize * this._speedFactor <= this.lastTimestep;\r\n    }\r\n\r\n    _getRequestSize(timestep) {\r\n        let size = this._numberOfCachedTimestepsAhead(this.lastRequestedTimestep)\r\n        if (this._config.cache.minRequestSize > size) {\r\n            size = this._config.cache.minRequestSize;\r\n        }\r\n        return size;\r\n    }\r\n\r\n    _onFetchingDataChanged() {\r\n        if (this._isFetchingDataChanged) {\r\n            this._isFetchingDataChanged();\r\n        }\r\n    }\r\n\r\n    onWorkerEvent(name, data) {\r\n        switch (name) {\r\n            case 'configDataReceived':\r\n                this._handleConfigDataReceived(data);\r\n                break;\r\n            case 'networkDataReceived':\r\n                this._networkDataChanged(data);\r\n                break;\r\n            case 'snapshotDataReceived':\r\n                this._handleSnapshotDataReceived(data);\r\n                break;\r\n            case 'planDataReceived':\r\n                this._handlePlanDataReceived(data);\r\n                break;\r\n            case 'geoJsonParsed':\r\n                this._handleGeoJsonParsed(data);\r\n                break;\r\n            default:\r\n                throw new Error('no such event name: ' + name);\r\n        }\r\n    }\r\n}\r\n\r\nexport { DataProvider }; \n\n\n// WEBPACK FOOTER //\n// ./src/modell/DataProvider.js","import { DataProvider } from './DataProvider.js';\r\nimport Configuration from '../contracts/Configuration.js';\r\n\r\nclass Playback {\r\n\r\n    get currentTimestep() {\r\n        return this._currentTimestep;\r\n    }\r\n\r\n    get timestepFraction() {\r\n        return this._timestepFraction;\r\n    }\r\n\r\n    set speedFactor(value) {\r\n\r\n        if (this._shouldRelaodShansphots(value)) {\r\n            this.dataProvider.clearCache();\r\n        }\r\n        this.dataProvider.speedFactor = value;\r\n        this._speedFactor = value;\r\n        this._timestepFraction = 0.0;\r\n    }\r\n\r\n    get speedFactor() {\r\n        return this._speedFactor;\r\n    }\r\n\r\n    set onTimestepChanged(callback) {\r\n        this._onTimestepChanged = callback;\r\n    }\r\n\r\n    constructor(dataProvider) {\r\n\r\n        this._config = Configuration.getConfig();\r\n        this._config.subscribeServerConfigUpdated(() => this._onServerConfigUpdated());\r\n\r\n        this._speedFactor = 1.0;\r\n        this.dataProvider = dataProvider;\r\n        this.dataProvider.speedFactor = this._speedFactor;\r\n\r\n        this._timestepFraction = 0;\r\n        let fps = 60;\r\n        this.timeBetweenFrames = 1000 / fps; //something like 16.7 ms for 60fps\r\n    }\r\n\r\n    _onServerConfigUpdated() {\r\n        this._currentTimestep = this._config.firstTimestep;\r\n        this.firstTimestep = this._config.firstTimestep;\r\n        this.lastTimestep = this._config.lastTimestep;\r\n        this.timestepSize = this._config.timestepSize;\r\n    }\r\n\r\n    shouldLoadNewSnapshot() {\r\n        return (this.timestepFraction === 0);\r\n    }\r\n\r\n    getSnapshotForCurrentTimestep() {\r\n\r\n        //1. Serve positions\r\n        let snapshot = this.dataProvider.getSnapshot(this.currentTimestep);\r\n        if (!snapshot.time) {\r\n            //return empty data\r\n            snapshot = {\r\n                position: new Float32Array(0),\r\n                nextPosition: new Float32Array(0),\r\n                shouldInterpolate: new Float32Array(0),\r\n                ids: new Float32Array(0),\r\n            };\r\n        }\r\n        return snapshot;\r\n    }\r\n\r\n    incrementTime() {\r\n        if (this.dataProvider.lastCachedTimestep > this.currentTimestep &&\r\n            this.currentTimestep >= this.dataProvider.firstCachedTimestep) {\r\n\r\n            this._incrementCurrentTime();\r\n        }\r\n        else if (this._reachedEndOfPlayback(this.currentTimestep)) {\r\n            this._resetToFirstTimestep();\r\n        }\r\n    }\r\n\r\n    seekTimestep(timestep) {\r\n\r\n        if (timestep > this.lastTimestep || timestep < this.firstTimestep) {\r\n            timestep = this.firstTimestep;\r\n        }\r\n\r\n        if (timestep < this.dataProvider.firstCachedTimestep) {\r\n            this.dataProvider.clearCache();\r\n        }\r\n        let modulo = timestep % this.timestepSize;\r\n        this._setCurrentTime(timestep - modulo);\r\n\r\n    }\r\n\r\n    isBuffering() {\r\n        return this.dataProvider.isFetchingData();\r\n    }\r\n\r\n    destroy() {\r\n        this._onTimestepChanged = null;\r\n    }\r\n\r\n    _incrementCurrentTime() {\r\n\r\n        let currentTime = this.currentTimestep + this.timestepFraction * this.timestepSize;\r\n        let nextTime = currentTime + this.timestepSize * this._speedFactor;\r\n        let newFraction = (nextTime - this.currentTimestep) / this.timestepSize;\r\n\r\n        if (newFraction >= 1.0) {\r\n            this._incrementCurrentTimestep();\r\n            this._timestepFraction = 0.0;\r\n        }\r\n        else {\r\n            this._timestepFraction = newFraction;\r\n        }\r\n    }\r\n\r\n    _incrementCurrentTimestep() {\r\n\r\n        let nextTimestep = 0;\r\n\r\n        if (this._speedFactor >= 1.0) {\r\n            nextTimestep = this.currentTimestep + this.timestepSize * this._speedFactor;\r\n        } else {\r\n            nextTimestep = this.currentTimestep + this.timestepSize;\r\n        }\r\n\r\n        if (this._reachedEndOfPlayback(nextTimestep)) {\r\n            this._resetToFirstTimestep();\r\n        }\r\n        else {\r\n            this._setCurrentTimestep(nextTimestep);\r\n        }\r\n    }\r\n\r\n    _setCurrentTime(value) {\r\n        this._timestepFraction = 0;\r\n        this._setCurrentTimestep(value);\r\n    }\r\n\r\n    _setCurrentTimestep(value) {\r\n        this._currentTimestep = value;\r\n        if (this._onTimestepChanged) {\r\n            this._onTimestepChanged(this._currentTimestep);\r\n        }\r\n    }\r\n\r\n    _shouldRelaodShansphots(newSpeedFactor) {\r\n        return (this._speedFactor > 1.0 || newSpeedFactor > 1.0);\r\n    }\r\n\r\n    _reachedEndOfPlayback(timestep) {\r\n        return (timestep + this.timestepSize * this._speedFactor > this.lastTimestep);\r\n    }\r\n\r\n    _resetToFirstTimestep() {\r\n        this._setCurrentTime(this.firstTimestep);\r\n        this.dataProvider.clearCache();\r\n    }\r\n}\r\n\r\nexport { Playback };\n\n\n// WEBPACK FOOTER //\n// ./src/modell/Playback.js","import { Rectangle } from '../contracts/Rectangle.js';\r\nimport Configuration from '../contracts/Configuration.js';\r\n\r\nclass MapInteractionController {\r\n\r\n    set clicked(callback) {\r\n        this._clicked = callback;\r\n    }\r\n\r\n    set redrawNeeded(callback) {\r\n        this._redrawNeeded = callback;\r\n    }\r\n\r\n    constructor(mapState) {\r\n        this._mapState = mapState;\r\n\r\n        let canvas = document.getElementById(Configuration.getConfig().canvasId);\r\n        this._boundPointerDown = (e) => this.onPointerDown(e);\r\n        this._boundPointerUp = (e) => this.onPointerUp(e);\r\n        this._boundPointerMove = (e) => this.onPointerMove(e);\r\n        this._boundMouseWheel = (e) => this.onMouseWheel(e);\r\n\r\n        let pointerDown = ('onpointerdown' in canvas) ? 'pointerdown' : 'mousedown';\r\n        let pointerUp = ('onpointerup' in canvas) ? 'pointerup' : 'mouseup';\r\n        let pointerMove = ('onpointermove' in canvas) ? 'pointermove' : 'mousemove';\r\n\r\n        canvas.addEventListener(pointerDown, this._boundPointerDown);\r\n        canvas.addEventListener(pointerUp, this._boundPointerUp);\r\n        canvas.addEventListener(pointerMove, this._boundPointerMove);\r\n        canvas.addEventListener('wheel', this._boundMouseWheel);\r\n    }\r\n\r\n    destroy() {\r\n        let canvas = document.getElementById(Configuration.getConfig().canvasId);\r\n        canvas.removeEventListener('mousedown', this._boundPointerDown);\r\n        canvas.removeEventListener('mouseup', this._boundPointerUp);\r\n        canvas.removeEventListener('mousemove', this._boundPointerMove);\r\n        canvas.removeEventListener('pointerdown', this._boundPointerDown);\r\n        canvas.removeEventListener('pointerup', this._boundPointerUp);\r\n        canvas.removeEventListener('pointermove', this._boundPointerMove);\r\n        canvas.removeEventListener('wheel', this._boundMouseWheel);\r\n\r\n\r\n        this._redrawNeeded = null;\r\n        this._clicked = null;\r\n    }\r\n\r\n    onPointerDown(args) {\r\n        this._isMouseDown = true;\r\n        this._oldX = args.offsetX;\r\n        this._oldY = args.offsetY;\r\n    }\r\n\r\n    onPointerUp(args) {\r\n        this._isMouseDown = false;\r\n        if (!this._mouseMoved) { //it's a click\r\n            let point = this._mapState.transformCoordinate(args.offsetX, args.offsetY);\r\n            this._clicked(point);\r\n        }\r\n        this._mouseMoved = false;\r\n    }\r\n\r\n    onPointerMove(args) {\r\n        if (this._isMouseDown) {\r\n            let dx = args.offsetX - this._oldX;\r\n            let dy = args.offsetY - this._oldY;\r\n            if (dx != 0 || dy != 0) {\r\n                this._mouseMoved = true;\r\n            }\r\n            this._oldX = args.offsetX;\r\n            this._oldY = args.offsetY;\r\n            this._mapState.moveMap(dx, -dy);\r\n            this._redrawNeeded();\r\n        }\r\n    }\r\n\r\n    onMouseWheel(args) {\r\n\r\n        let x = args.offsetX;\r\n        let y = args.offsetY;\r\n\r\n        if (args.deltaY < 0) {\r\n            this._mapState.zoomInReCenter(x, y);\r\n        }\r\n        else {\r\n            this._mapState.zoomOutReCenter(x, y);\r\n        }\r\n        this._redrawNeeded();\r\n        args.preventDefault();\r\n        args.stopPropagation();\r\n    }\r\n}\r\n\r\nexport { MapInteractionController };\n\n\n// WEBPACK FOOTER //\n// ./src/view/MapInteractionController.js","import { Rectangle } from '../contracts/Rectangle.js';\r\nimport { OrthographicCamera } from 'three';\r\n\r\nclass MapState {\r\n\r\n    static ZOOMFACTOR() { return 1.1; }\r\n\r\n    get bounds() {\r\n        return this._bounds;\r\n    }\r\n\r\n    set bounds(bounds) {\r\n        this._bounds = bounds;\r\n        this._adjustCameraToBounds();\r\n    }\r\n\r\n    get camera() {\r\n        return this._camera;\r\n    }\r\n\r\n    get scale() {\r\n        return this._scale;\r\n    }\r\n\r\n    /**\r\n     * Map state handles the translation of screen coordinates into world coordinates the bounds are expected to be \r\n     * in right hand coordinates -> lef < right, bottom < top\r\n     * @param {*Rectangle} bounds - bounds of the rectangle that should be shown\r\n     */\r\n    constructor(bounds) {\r\n        this._bounds = bounds;\r\n        this._scale = 1;\r\n        this._camera = new OrthographicCamera(bounds.left, bounds.right, bounds.top, bounds.bottom, 1, 100);\r\n        this._camera.position.z = 1;\r\n        this._camera.frustumCulled = false;\r\n    }\r\n\r\n    transformCoordinate(offsetX, offsetY) {\r\n        return {\r\n            x: offsetX * this._scale + this.bounds.left,\r\n            y: this.bounds.bottom + this.bounds.height - offsetY * this._scale\r\n        };\r\n    }\r\n\r\n    resizeMap(toWidth, toHeight) {\r\n\r\n        this.bounds = Rectangle.createRectFromCenterDimensions(\r\n            this.bounds.centerX,\r\n            this.bounds.centerY,\r\n            toWidth * this._scale,\r\n            toHeight * this._scale);\r\n    }\r\n\r\n    resizeMapEnclose(rectangle) {\r\n        let aspect = this.bounds.width / this.bounds.height;\r\n        let newBounds;\r\n\r\n        if (rectangle.width > rectangle.height) {\r\n            newBounds = Rectangle.createRectFromCenterDimensions(\r\n                rectangle.centerX,\r\n                rectangle.centerY,\r\n                rectangle.width,\r\n                rectangle.width / aspect);\r\n        }\r\n        else {\r\n            newBounds = Rectangle.createRectFromCenterDimensions(\r\n                rectangle.centerX,\r\n                rectangle.centerY,\r\n                rectangle.height * aspect,\r\n                rectangle.height\r\n            );\r\n        }\r\n        this._scale = newBounds.width / this.bounds.width;\r\n        this.bounds = newBounds;\r\n    }\r\n\r\n    moveMap(offsetX, offsetY) {\r\n        this.bounds = Rectangle.createRectFromOffset(\r\n            this.bounds,\r\n            -offsetX * this._scale,\r\n            -offsetY * this._scale\r\n        );\r\n    }\r\n\r\n    moveMapTo(centerX, centerY) {\r\n        this.bounds = Rectangle.createRectFromCenterDimensions(\r\n            centerX,\r\n            centerY,\r\n            this.bounds.width,\r\n            this.bounds.height\r\n        );\r\n    }\r\n\r\n    zoomInReCenter(offsetX, offsetY) {\r\n        this._zoomReCenter(1 / MapState.ZOOMFACTOR(), offsetX, offsetY);\r\n    }\r\n\r\n    zoomOutReCenter(offsetX, offsetY) {\r\n        this._zoomReCenter(MapState.ZOOMFACTOR(), offsetX, offsetY)\r\n    }\r\n\r\n    _zoomReCenter(factor, offsetX, offsetY) {\r\n\r\n        //1. Translate center\r\n        //calculate center of zoom\r\n        let zoomCenterX = offsetX * this._scale + this.bounds.left;\r\n        let zoomCenterY = this.bounds.bottom + this.bounds.height - offsetY * this._scale;\r\n\r\n        this._scale = this._scale * factor;\r\n\r\n        //calculate the center of zoom relative to bounds as e.g. offset/width\r\n        let relativeX = (zoomCenterX - this.bounds.left) / this.bounds.width;\r\n        let relativeY = (zoomCenterY - this.bounds.bottom) / this.bounds.height;\r\n\r\n        //2. zoom\r\n        let width = this._bounds.width * factor;\r\n        let height = this._bounds.height * factor;\r\n\r\n        //3. Translate back\r\n        //calculate bounds\r\n        let left = zoomCenterX - width * relativeX;\r\n        let right = zoomCenterX + width * (1 - relativeX);\r\n        let top = zoomCenterY + height * (1 - relativeY);\r\n        let bottom = zoomCenterY - height * relativeY;\r\n        this.bounds = new Rectangle(left, right, top, bottom);\r\n    }\r\n\r\n    _adjustCameraToBounds() {\r\n        this._camera.left = this._bounds.left;\r\n        this._camera.right = this._bounds.right;\r\n        this._camera.top = this._bounds.top;\r\n        this._camera.bottom = this._bounds.bottom;\r\n        this._camera.updateProjectionMatrix();\r\n    }\r\n}\r\n\r\nexport { MapState };\n\n\n// WEBPACK FOOTER //\n// ./src/view/MapState.js","class Http {\r\n\r\n    static URLPATH_NETWORK() { return \"network\"; }\r\n    static URLPATH_SNAPSHOTS() { return \"snapshots\"; }\r\n    static URLPATH_PLAN() { return 'plan'; }\r\n    static URLPATH_CONFIGURATION() { return \"configuration\"; }\r\n    static STATUS_OK() { return 200; }\r\n    static RESPONSETYPE_TEXT() { return 'text'; }\r\n    static RESPONSETYPE_BUFFER() { return 'arraybuffer'; }\r\n\r\n    constructor(dataUrl) {\r\n        console.log(dataUrl);\r\n        this._dataUrl = dataUrl;\r\n    }\r\n\r\n    getConfigData(success, error) {\r\n        let url = this._dataUrl + Http.URLPATH_CONFIGURATION();\r\n        console.log(url);\r\n        this.makePostRequest(url, {}, Http.RESPONSETYPE_TEXT(), success, error);\r\n    }\r\n\r\n    getNetworkData(success, error) {\r\n        let url = this._dataUrl + Http.URLPATH_NETWORK();\r\n        this.makePostRequest(url, {}, Http.RESPONSETYPE_BUFFER(), success, error);\r\n    }\r\n\r\n    getSnapshotData(parameters, success, error) {\r\n        let url = this._dataUrl + Http.URLPATH_SNAPSHOTS();\r\n        this.makePostRequest(url, parameters, Http.RESPONSETYPE_BUFFER(), success, error);\r\n    }\r\n\r\n    getPlan(parameters, success, error) {\r\n        var url = this._dataUrl + Http.URLPATH_PLAN();\r\n        this.makePostRequest(url, parameters, Http.RESPONSETYPE_TEXT(), success, error);\r\n    }\r\n\r\n    makePostRequest(url, data, responseType, success, error) {\r\n        console.log(url);\r\n        console.log('heee');\r\n        let request = new XMLHttpRequest();\r\n        request.onreadystatechange = () => this.readyStateChangedHandler(request, success, error);\r\n        let dataString = JSON.stringify(data);\r\n        request.open('POST', url);\r\n        request.setRequestHeader(\"Content-type\", \"application/JSON\");\r\n        request.responseType = responseType;\r\n        request.send(dataString);\r\n    }\r\n\r\n    readyStateChangedHandler(request, success, error) {\r\n        if (Http.isRequestDone(request)) {\r\n            if (Http.isStatusSuccess(request)) {\r\n                success(request.response);\r\n            }\r\n            else {\r\n                console.log('Error in Webrequest. Code: ' + request.status);\r\n                if (error) {\r\n                    error({ message: 'error in web request', status: request.status});\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    static isRequestDone(request) {\r\n        return request.readyState === XMLHttpRequest.DONE;\r\n    }\r\n\r\n    static isStatusSuccess(request) {\r\n        return request.status === Http.STATUS_OK();\r\n    }\r\n}\r\n\r\nexport { Http };\n\n\n// WEBPACK FOOTER //\n// ./src/communication/http.js","class Shader {\r\n\r\n    static interpolatePositionsVertexShader() {\r\n        return `\r\n                attribute vec3 nextPosition;\r\n                attribute float shouldInterpolate;\r\n                attribute float id;\r\n\r\n                uniform float timestepFraction;\r\n                uniform float size;\r\n                uniform float hitTestThreshold;\r\n                uniform float selectedId;\r\n\r\n                varying float vRotation;\r\n                varying float vShouldInterpolate;\r\n                varying float vIsSelected;\r\n                varying float vIsHover;\r\n\r\n                vec3 interpolate(in vec3 pos1, in vec3 pos2, in float timestepFraction, in float shouldInterpolate) {\r\n                    \r\n                    if(shouldInterpolate >= 0.0) {\r\n                        vec3 direction = (pos2 - pos1);\r\n                        vRotation = atan(direction.x, direction.y);\r\n                        return (direction * timestepFraction) + pos1;\r\n                    }\r\n                    else {\r\n                        vRotation = 0.0;\r\n                        return pos1;\r\n                    }\r\n                }\r\n\r\n                float isIdSelected() {\r\n\r\n                    float result = 0.0;\r\n\r\n                    if(selectedId == id) {\r\n                        result = 1.0;\r\n                    }\r\n                    return result;\r\n                }\r\n\r\n                float getSize() {\r\n                    float result = 0.0;\r\n\r\n                    if (vIsSelected >= 1.0) {\r\n                        result = size * 3.0;\r\n                    } else if (shouldInterpolate < 1.0) {\r\n                        result = size * 0.7;\r\n                    } else {\r\n                        result = size;\r\n                    }\r\n                    return result;\r\n                }\r\n\r\n                void main() {\r\n\r\n                    vIsSelected = isIdSelected();\r\n\r\n                    gl_PointSize = getSize();\r\n                    \r\n                    vShouldInterpolate = shouldInterpolate;\r\n                    vec3 interpolated = interpolate(position, nextPosition, timestepFraction, shouldInterpolate);\r\n\r\n                    if (vIsSelected >= 1.0) {\r\n                        interpolated.z = 1.0;\r\n                    }\r\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(interpolated, 1.0);\r\n                }\r\n        `;\r\n    }\r\n\r\n    static interpolatePositionsFragmentShader() {\r\n        return `\r\n                uniform vec3 color;\r\n                uniform vec3 selectedColor;\r\n                uniform float timestepFraction;\r\n\r\n                uniform sampler2D triangle;\r\n                uniform sampler2D circle;\r\n                \r\n                varying float vRotation;\r\n                varying float vShouldInterpolate;\r\n                varying float vIsSelected;\r\n                \r\n                vec2 rotateCoordinates() {\r\n                    mat2 rotationMatrix = mat2(cos(vRotation), sin(vRotation), -sin(vRotation), cos(vRotation));\r\n\r\n                    vec2 centerBasedCoord = vec2(gl_PointCoord.x -0.5, gl_PointCoord.y - 0.5);\r\n                    vec2 centerBasedRotatedCoord = centerBasedCoord * rotationMatrix;\r\n                    return centerBasedRotatedCoord + 0.5;\r\n                }\r\n\r\n                vec4 getColor() {\r\n                    \r\n                    vec4 result;\r\n\r\n                    if (vIsSelected >= 1.0) {\r\n                        result = vec4(selectedColor, 1.0);\r\n                    }\r\n                    else {\r\n                        result = vec4(color, 1.0);\r\n                    }\r\n                    return result;\r\n                }\r\n\r\n                void main() {\r\n\r\n                    vec4 opaqueColor = getColor();\r\n\r\n                    if (vShouldInterpolate >= 1.0) {\r\n                        vec2 coord = rotateCoordinates();\r\n                        gl_FragColor = opaqueColor * texture2D(triangle, coord);\r\n                    } else {\r\n                        opaqueColor.a = 1.0 - timestepFraction;\r\n                        gl_FragColor = opaqueColor * texture2D(circle, gl_PointCoord);\r\n                    }\r\n\r\n                    if ( gl_FragColor.a < ALPHATEST ) discard;\r\n                }\r\n        `;\r\n    }\r\n}\r\n\r\nexport { Shader };\n\n\n// WEBPACK FOOTER //\n// ./src/view/Shader.js","import { Rectangle } from '../contracts/Rectangle.js';\r\nimport { Http } from '../communication/http.js';\r\nimport { Playback } from '../modell/Playback';\r\nimport { MapState } from './MapState.js';\r\nimport { MapInteractionController } from './MapInteractionController.js';\r\nimport { Shader } from './Shader.js';\r\nimport { BufferHolder } from './BufferHolder.js';\r\nimport Configuration from '../contracts/Configuration.js';\r\nimport {\r\n    WebGLRenderer,\r\n    Raycaster,\r\n    Vector3,\r\n} from 'three';\r\n\r\nimport triangle from 'file-loader!./assets/triangle-32.png';\r\nimport circle from 'file-loader!./assets/circle-32.png'\r\n\r\nclass DrawingController {\r\n\r\n    static AGENT_LAYER() { return 'agent-layer'; }\r\n    static NETWORK_LAYER() { return 'network-layer'; }\r\n\r\n    set mapState(mapState) {\r\n        this._mapState = mapState;\r\n        this.resize();\r\n    }\r\n\r\n    get mapState() {\r\n        return this._mapState;\r\n    }\r\n\r\n    set interactionController(controller) {\r\n        this._interactionController = controller;\r\n        controller.clicked = (p) => this.raycast(p);\r\n        controller.redrawNeeded = () => this.renderOnce(false);\r\n    }\r\n\r\n    get interactionController() {\r\n        return this._interactionController;\r\n    }\r\n\r\n    set playback(value) {\r\n        this._playback = value;\r\n    }\r\n\r\n    get playback() {\r\n        return this._playback;\r\n    }\r\n\r\n    set dataProvider(dataProvider) {\r\n        this._dataProvider = dataProvider;\r\n    }\r\n\r\n    get dataProvider() {\r\n        return this._dataProvider;\r\n    }\r\n\r\n    constructor() {\r\n        this.initialize();\r\n    }\r\n\r\n    initialize() {\r\n        this._config = Configuration.getConfig();\r\n        this._config.subscribeServerConfigUpdated(() => this._onServerConfigUpdated())\r\n\r\n        let canvas = document.getElementById(this._config.canvasId);\r\n        this.renderer = new WebGLRenderer({ canvas: canvas, antialias: true });\r\n        this.renderer.setPixelRatio(window.devicePixelRatio);\r\n\r\n        this._bufferHolder = new BufferHolder();\r\n        this._bufferHolder.redrawNeeded = () => this.renderOnce(false);\r\n        this.mapState = new MapState(new Rectangle(0, 0, 0, 0));\r\n        this.interactionController = new MapInteractionController(this.mapState);\r\n        this._raycaster = new Raycaster();\r\n\r\n        this.resize();\r\n        this._boundResize = (e) => this.resize(e);\r\n        window.addEventListener('resize', this._boundResize);\r\n    }\r\n\r\n    destroy() {\r\n        window.removeEventListener('resize', this._boundResize);\r\n        this.stopPlayback();\r\n        this.renderer.dispose();\r\n        this._interactionController.destroy();\r\n    }\r\n\r\n    _onServerConfigUpdated() {\r\n        let rawBounds = this._config.bounds;\r\n        let bounds = new Rectangle(rawBounds.left, rawBounds.right, rawBounds.top, rawBounds.bottom);\r\n        this.mapState.resizeMapEnclose(bounds);\r\n        this.dataProvider.networkDataChanged = (data) => this.onNetworkDataChanged(data);\r\n        this.dataProvider.geoJsonDataChanged = (layerName) => this.onGeoJsonDataChanged(layerName);\r\n        this.dataProvider.loadNetworkData();\r\n    }\r\n\r\n    onNetworkDataChanged(data) {\r\n        this._bufferHolder.clearNetworkBuffer();\r\n        this._bufferHolder.loadNetworkBuffer(data);\r\n        this.renderOnce(false);\r\n    }\r\n\r\n    onGeoJsonDataChanged(layerName) {\r\n        this._bufferHolder.clearGeoJsonBuffer(layerName);\r\n        let layer = this.dataProvider.getLayer(layerName);\r\n        this._bufferHolder.loadGeoJsonBuffer(layer);\r\n        this.renderOnce(false);\r\n    }\r\n\r\n    resize() {\r\n        let canvas = document.getElementById(this._config.canvasId);\r\n        let width = canvas.clientWidth;\r\n        let height = canvas.clientHeight;\r\n        canvas.width = width * window.devicePixelRatio;\r\n        canvas.height = height * window.devicePixelRatio;\r\n\r\n        this.resizeMap(width, height);\r\n        this.renderer.setViewport(0, 0, width, height);\r\n        this.renderOnce(false);\r\n    }\r\n\r\n    resizeMap(width, height) {\r\n\r\n        if (this.mapState) {\r\n            if (this.mapState.bounds.width === 0 || this.mapState.bounds.height === 0) {\r\n                this.mapState.bounds = new Rectangle(0, width, 0, height);\r\n            }\r\n            else {\r\n                this.mapState.resizeMap(width, height);\r\n            }\r\n        }\r\n    }\r\n\r\n    raycast(point) {\r\n\r\n        if (!this._bufferHolder.hasAgentLayer) return;\r\n\r\n        this._raycaster.params.Points.threshold = 10 * this.mapState.scale;\r\n        let ray = new Vector3(point.x, point.y, 0);\r\n        this._raycaster.set(ray, new Vector3(0, 0, -1));\r\n        let agentLayer = this._bufferHolder.getLayer(BufferHolder.AGENT_LAYER());\r\n        let intersects = this._raycaster.intersectObject(agentLayer, false);\r\n        if (intersects.length > 0) {\r\n            let idIndex = this.dataProvider.getId(intersects[0].index, this.playback.currentTimestep);\r\n            this.dataProvider.loadPlan(idIndex);\r\n            this._bufferHolder.updateAgentBufferUniform('selectedId', idIndex);\r\n        }\r\n        else {\r\n            this._bufferHolder.updateAgentBufferUniform('selectedId', -1);\r\n            this._bufferHolder.clearGeoJsonBuffer('selectedPlan');\r\n        }\r\n        if (!this.shouldRender)\r\n            this.renderOnce(false);\r\n    }\r\n\r\n    startPlayback() {\r\n        if (!this.shouldRender) {\r\n            this._bufferHolder.loadAgentBuffer();\r\n            this.shouldRender = true;\r\n            this.render();\r\n        }\r\n    }\r\n\r\n    stopPlayback() {\r\n        this.shouldRender = false;\r\n    }\r\n\r\n    render() {\r\n        if (!this.shouldRender)\r\n            return;\r\n\r\n        requestAnimationFrame(() => this.render());\r\n        this.renderOnce(true);\r\n    }\r\n\r\n    renderOnce(isAnimationFrame) {\r\n        if (isAnimationFrame) {\r\n            this.playback.incrementTime();\r\n            this._animateAgents();\r\n        }\r\n        this.renderer.render(this._bufferHolder.scene, this.mapState.camera);\r\n    }\r\n\r\n    _animateAgents() {\r\n\r\n        if (!this.playback || !this._bufferHolder.hasAgentLayer || !this.shouldRender) {\r\n            return;\r\n        }\r\n\r\n        if (this.playback.shouldLoadNewSnapshot()) {\r\n            let snapshot = this.playback.getSnapshotForCurrentTimestep();\r\n            this._bufferHolder.updateAgentBufferAttribute('position', snapshot.position);\r\n            this._bufferHolder.updateAgentBufferAttribute('nextPosition', snapshot.nextPosition);\r\n            this._bufferHolder.updateAgentBufferAttribute('shouldInterpolate', snapshot.shouldInterpolate);\r\n            this._bufferHolder.updateAgentBufferAttribute('id', snapshot.ids);\r\n        }\r\n\r\n        this._bufferHolder.updateAgentBufferUniform('timestepFraction', this.playback.timestepFraction);\r\n    }\r\n}\r\n\r\nexport { DrawingController };\n\n\n// WEBPACK FOOTER //\n// ./src/view/DrawingController.js","module.exports = function() {\n\treturn new Worker(__webpack_public_path__ + \"b1bc9e47835152906700.worker.js\");\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modell/background/DataFetcher.worker.js","module.exports = function() {\n\treturn new Worker(__webpack_public_path__ + \"a57fa866e23a9a126393.worker.js\");\n};\n\n\n// WEBPACK FOOTER //\n// ./src/modell/background/GeoJsonParser.worker.js","class LayerData {\r\n\r\n    get layers() {\r\n        return this._layers;\r\n    }\r\n\r\n    constructor() {\r\n        this._layers = [];\r\n    }\r\n\r\n    addLayer(layer) {\r\n\r\n        //check whether a layer with the name exists\r\n        let foundIndex = -1;\r\n        let foundLayer = this._layers.find((entry, index) => {\r\n            if (entry.name === layer.name) {\r\n                foundIndex = index;\r\n                return true;\r\n            }\r\n        });\r\n\r\n        if (foundIndex >= 0) {\r\n            this._layers.splice(foundIndex, 1, layer);\r\n        }\r\n        else {\r\n            this._layers.push(layer);\r\n        }\r\n    }\r\n\r\n    removeLayer(layerName) {\r\n        let foundIndex = -1;\r\n        this._layers.find((entry, index) => {\r\n            if (entry.name === layerName) {\r\n                foundIndex = index;\r\n                return true;\r\n            }\r\n        });\r\n\r\n        if (foundIndex >= 0) {\r\n            this._layers.splice(foundIndex, 1);\r\n        }\r\n    }\r\n\r\n    getLayer(layerName) {\r\n        let layer = this._layers.find((entry) => {\r\n            return layerName === entry.name;\r\n        });\r\n        return layer;\r\n    }\r\n\r\n    static createLayer(name, z, color, data) {\r\n        return {\r\n            name: name,\r\n            z: z,\r\n            color: color,\r\n            points: data.points,\r\n            lines: data.lines,\r\n            shapeVertices: data.shapeVertices,\r\n            shapeNormals: data.shapeNormals,\r\n        };\r\n    }\r\n}\r\n\r\nexport { LayerData };\n\n\n// WEBPACK FOOTER //\n// ./src/modell/LayerData.js","class SnapshotData {\r\n\r\n    get firstTimestep() {\r\n        if (this._hasSnapshots()) {\r\n            return this.snapshots[0].time;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    get lastTimestep() {\r\n        if (this._hasSnapshots()) {\r\n            return this.snapshots[this.snapshots.length - 1].time;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    constructor(timestepSize) {\r\n        this.timestepSize = timestepSize;\r\n        this.snapshots = new Array();\r\n    }\r\n\r\n    addSnapshotsAndForgetOldOnes(data, smallestTimestepToKeepCached, speedFactor) {\r\n\r\n        //there was a jump in on the timeline, so all cached snapshots can be deleted\r\n        if (this.snapshots.length == 0 || smallestTimestepToKeepCached > this.lastTimestep) {\r\n            this.snapshots = data;\r\n        }\r\n        //otherwise we can forget older snapshots and append the newly loaded snapshots\r\n        else if (data.length > 0) {\r\n            let firstTimestepToAppend = data[0].time;\r\n            let indexToKeep = this._getIndexForTimestep(smallestTimestepToKeepCached, speedFactor);\r\n            let dataToAppend;\r\n\r\n            if (!this._canTimestepBeAppended(firstTimestepToAppend)) {\r\n                dataToAppend = this._makeSnapshotsAppendable(data);\r\n            } else {\r\n                dataToAppend = data;\r\n            }\r\n\r\n            if (dataToAppend) {\r\n                //remove the last snaphot, since we'll get a new one\r\n                this.snapshots.splice(this.snapshots.length - 1, 1);\r\n\r\n                //get rid of old snapshots and concatenate the new ones\r\n                this.snapshots = this.snapshots.slice(indexToKeep).concat(data);\r\n            }\r\n            else {\r\n                throw new Error('new Data didn\"t fit lastTimestep: ' + this.lastTimestep + ' first new timestep: ' + firstTimestepToAppend);\r\n            }\r\n        }\r\n    }\r\n\r\n    getSnapshot(timestep, speedFactor) {\r\n        //ensure timeststep is within bounds\r\n        if (this.firstTimestep - 0.0001 > timestep || this.lastTimestep + 0.0001 < timestep) {\r\n            throw new RangeError('timestep: ' + timestep + ' was not within chached timespan');\r\n        }\r\n\r\n        if (speedFactor < 1.0) {\r\n            throw new RangeError('speedFactor must not be smaller than 1.0 but was: ' + speedFactor);\r\n        }\r\n        //calculate index\r\n        let index = this._getIndexForTimestep(timestep, speedFactor);\r\n        return this.snapshots[Math.floor(index)];\r\n    }\r\n\r\n    hasSnapshotFor(timestep) {\r\n        return this.firstTimestep <= timestep && this.lastTimestep >= timestep;\r\n    }\r\n\r\n    clearSnapshots() {\r\n        this.snapshots = [];\r\n    }\r\n\r\n    _getIndexForTimestep(timestep, speedFactor) {\r\n        let index = (timestep - this.firstTimestep) / this.timestepSize / speedFactor;\r\n\r\n        if (index < 0) {\r\n            index = 0;\r\n        }\r\n        return index;\r\n    }\r\n\r\n    _canTimestepBeAppended(timestep) {\r\n        //timestep must be the same as last timestep\r\n        return this.lastTimestep + 0.0001 > timestep && this.lastTimestep - 0.0001 < timestep;\r\n    }\r\n\r\n    _makeSnapshotsAppendable(data) {\r\n        for (let i = 0; i < data.length; i++) {\r\n            if (this._canTimestepBeAppended(data[i].time)) {\r\n                return data.slice(i);\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    _hasSnapshots() {\r\n        return this.snapshots.length > 0;\r\n    }\r\n}\r\n\r\nexport { SnapshotData };\n\n\n// WEBPACK FOOTER //\n// ./src/modell/SnapshotData.js","class WorkerFacade {\r\n\r\n    constructor(worker, eventCallback) {\r\n        if (worker) {\r\n            this.worker = new worker();\r\n            this.boundHandelWorkerMessage = e => this.handleWorkerMessage(e);\r\n            this.worker.addEventListener('message', this.boundHandelWorkerMessage);\r\n            this.eventCallback = eventCallback;\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        if (this.worker) {\r\n            this.worker.removeEventListener('message', this.boundHandelWorkerMessage);\r\n            this.worker.terminate();\r\n        }\r\n    }\r\n\r\n    handleWorkerMessage(e) {\r\n        let then = Date.now();\r\n        let data = e.data;\r\n\r\n        switch (data.type) {\r\n            case 'error':\r\n                console.error('Error in Web-Worker: ' + data.message);\r\n                break;\r\n            case 'log':\r\n                console.log('Info Web-Worker: ' + data.message);\r\n                break;\r\n            case 'event':\r\n                this.onWorkerEvent(data.name, data.data);\r\n                break;\r\n            default:\r\n                this.onWorkerMessageReceived(data);\r\n        }\r\n        let time = Date.now() - then;\r\n        if(data.name) {\r\n            console.log('handle WorkerMessage \"' + data.name + '\" took: ' + time + 'ms');\r\n        }\r\n    }\r\n\r\n    onWorkerMessageReceived(data) {\r\n        //nothing: subclasses can override this method\r\n        console.error('PlaybackController._handleWorkerMessage: Error! receivd unknown message type');\r\n\r\n    }\r\n\r\n    onWorkerEvent(name, data) {\r\n        this.eventCallback(name, data);\r\n    }\r\n\r\n    postWorkerMessage(methodName, parameters) {\r\n        if (this.worker) {\r\n            this.worker.postMessage({ method: methodName, parameters: parameters });\r\n        }\r\n    }\r\n\r\n    postWorkerMessage(methodName, data, transferrables) {\r\n        if (this.worker) {\r\n            let obj = {\r\n                method: methodName,\r\n                parameters: data\r\n            };\r\n            this.worker.postMessage(obj, transferrables);\r\n        }\r\n    }\r\n}\r\n\r\nexport { WorkerFacade };\n\n\n// WEBPACK FOOTER //\n// ./src/modell/background/WorkerFacade.js","import {\r\n\r\n    BufferAttribute,\r\n    BufferGeometry,\r\n    Color,\r\n    LineBasicMaterial,\r\n    LineSegments,\r\n    Mesh,\r\n    MeshBasicMaterial,\r\n    NearestFilter,\r\n    Points,\r\n    PointsMaterial,\r\n    Scene,\r\n    ShaderMaterial,\r\n    TextureLoader,\r\n    Vector2\r\n} from 'three';\r\n\r\nimport { Shader } from './Shader.js';\r\nimport Configuration from '../contracts/Configuration.js';\r\n\r\n\r\nimport triangle from 'file-loader!./assets/triangle-64.png';\r\nimport circle from 'file-loader!./assets/circle-64.png'\r\n\r\nclass BufferHolder {\r\n\r\n    static AGENT_LAYER() { return 'agent-layer'; }\r\n    static NETWORK_LAYER() { return 'network-layer'; }\r\n\r\n    get scene() {\r\n        return this._scene;\r\n    }\r\n\r\n    get hasAgentLayer() {\r\n        return this._hasLayer(BufferHolder.AGENT_LAYER());\r\n    }\r\n\r\n    set redrawNeeded(callback) {\r\n        this._redrawNeeded = callback;\r\n    }\r\n\r\n    constructor() {\r\n        this._config = Configuration.getConfig();\r\n        this._scene = new Scene();\r\n        this._scene.background = new Color(this._config.colors.background);\r\n    }\r\n\r\n    destroy() {\r\n        this._redrawNeeded = null;\r\n        this._scene = null;\r\n    }\r\n\r\n    clearNetworkBuffer() {\r\n        this._clearBuffer(BufferHolder.NETWORK_LAYER());\r\n    }\r\n\r\n    clearAgentBuffer() {\r\n        this._clearBuffer(BufferHolder.AGENT_LAYER());\r\n    }\r\n\r\n    clearGeoJsonBuffer(layerName) {\r\n        this._clearBuffer('p' + layerName);\r\n        this._clearBuffer('l' + layerName);\r\n        this._clearBuffer('s' + layerName);\r\n    }\r\n\r\n    _clearBuffer(layerName) {\r\n        if (this._scene.children) {\r\n            let layer = this._scene.getObjectByName(layerName);\r\n            this.scene.remove(layer);\r\n        }\r\n    }\r\n\r\n    loadNetworkBuffer(links) {\r\n        if (!this._hasLayer(BufferHolder.NETWORK_LAYER())) {\r\n            let lines = this._createLineMesh(BufferHolder.NETWORK_LAYER(), links, -11, this._config.colors.network);\r\n            this._scene.add(lines);\r\n        }\r\n    }\r\n\r\n    loadAgentBuffer() {\r\n\r\n        if (this._hasLayer(BufferHolder.AGENT_LAYER())) return;\r\n\r\n        let shaderMaterial = new ShaderMaterial({\r\n            vertexShader: Shader.interpolatePositionsVertexShader(),\r\n            fragmentShader: Shader.interpolatePositionsFragmentShader(),\r\n            uniforms: {\r\n                timestepFraction: { value: 0.0 },\r\n                size: { value: 10.0 * window.devicePixelRatio },\r\n                hitTestThreshold: { value: 100.0 },\r\n                selectedId: { value: -1 },\r\n                mousePosition: { value: new Vector2(0, 0) },\r\n\r\n                color: { value: new Color(this._config.colors.agents) },\r\n                selectedColor: { value: new Color(this._config.colors.selectedAgent) },\r\n                triangle: { value: this._createTexture(triangle) },\r\n                circle: { value: this._createTexture(circle) },\r\n            },\r\n            transparent: true,\r\n            alphaTest: 0.1,\r\n        });\r\n        let points = new Points(new BufferGeometry(), shaderMaterial);\r\n        points.name = BufferHolder.AGENT_LAYER();\r\n        points.frustumCulled = false;\r\n        points.position.z = -10;\r\n        this._scene.add(points);\r\n\r\n        this._createAgentBufferAttribute('position', 3);\r\n        this._createAgentBufferAttribute('nextPosition', 3);\r\n        this._createAgentBufferAttribute('shouldInterpolate', 1);\r\n        this._createAgentBufferAttribute('id', 1);\r\n    }\r\n\r\n    loadGeoJsonBuffer(layer) {\r\n\r\n        if (!layer) return;\r\n\r\n        if (layer.points && layer.points.length > 0) {\r\n            let points = this._createPointsMesh('p' + layer.name, layer.points, layer.z, 16, layer.color, circle);\r\n            this._scene.add(points);\r\n        }\r\n\r\n        if (layer.lines && layer.lines.length > 0) {\r\n            let lines = this._createLineMesh('l' + layer.name, layer.lines, layer.z, layer.color);\r\n            this._scene.add(lines);\r\n        }\r\n        if (layer.shapeVertices && layer.shapeVertices.length > 0 &&\r\n            layer.shapeNormals && layer.shapeNormals.length == layer.shapeVertices.length) {\r\n            let shapes = this._createShapeMesh('s' + layer.name, layer.shapeVertices, layer.shapeNormals, layer.z, layer.color);\r\n            this._scene.add(shapes);\r\n        }\r\n    }\r\n\r\n    _createAgentBufferAttribute(name, itemSize) {\r\n        let attribute = new BufferAttribute(new Float32Array([]), itemSize);\r\n        let agentLayer = this._scene.getObjectByName(BufferHolder.AGENT_LAYER());\r\n        agentLayer.geometry.addAttribute(name, attribute);\r\n    }\r\n\r\n    updateAgentBufferAttribute(name, array) {\r\n        let agentLayer = this._scene.getObjectByName(BufferHolder.AGENT_LAYER());\r\n        let attribute = agentLayer.geometry.getAttribute(name);\r\n        attribute.setArray(array);\r\n        attribute.needsUpdate = true;\r\n    }\r\n\r\n    updateAgentBufferUniform(name, value) {\r\n        let agentLayer = this._scene.getObjectByName(BufferHolder.AGENT_LAYER());\r\n        agentLayer.material.uniforms[name].value = value;\r\n    }\r\n\r\n    getLayer(layerName) {\r\n        return this._scene.getObjectByName(layerName);\r\n    }\r\n\r\n    _createLineMesh(name, lines, z, color) {\r\n        let material = new LineBasicMaterial({ color: color });\r\n        let geometry = this._createBufferGeometry(lines);\r\n        let mesh = new LineSegments(geometry, material);\r\n        this._setMeshProperties(mesh, name, z);\r\n        return mesh;\r\n    }\r\n\r\n    _createPointsMesh(name, points, z, size, color, image) {\r\n        let material = new PointsMaterial({ color: color, sizeAttenuation: false, size: size });\r\n\r\n        if (image) {\r\n            material.map = this._createTexture(image, this._redrawNeeded);\r\n            material.alphaTest = 0.9;\r\n        }\r\n        let geometry = this._createBufferGeometry(points);\r\n        let mesh = new Points(geometry, material);\r\n        this._setMeshProperties(mesh, name, z);\r\n        return mesh;\r\n    }\r\n\r\n    _createShapeMesh(name, vertices, normals, z, color) {\r\n        let material = new MeshBasicMaterial({ color: color });\r\n        let geometry = this._createBufferGeometry(vertices);\r\n        geometry.addAttribute('normal', new BufferAttribute(normals, 3));\r\n        let mesh = new Mesh(geometry, material);\r\n        mesh.name = name;\r\n        mesh.position.z = z;\r\n        return mesh;\r\n    }\r\n\r\n    _createBufferGeometry(positions) {\r\n        let attribute = new BufferAttribute(positions, 3);\r\n        let geometry = new BufferGeometry();\r\n        geometry.addAttribute('position', attribute);\r\n        geometry.verticesNeedUpdate = true;\r\n        return geometry;\r\n    }\r\n\r\n    _createTexture(image, callback) {\r\n\r\n        let texture;\r\n\r\n        if (callback) {\r\n            texture = new TextureLoader().load(image, (t) => callback());\r\n        } else {\r\n            texture = new TextureLoader().load(image);\r\n        }\r\n\r\n        texture.flipY = false;\r\n        texture.magFilter = NearestFilter;\r\n        texture.minFilter = NearestFilter;\r\n        return texture;\r\n    }\r\n\r\n    _setMeshProperties(mesh, name, z) {\r\n        mesh.name = name;\r\n        mesh.position.z = z;\r\n        mesh.frustumCulled = false;\r\n    }\r\n\r\n    _hasLayer(name) {\r\n        if (this._scene.getObjectByName(name)) {\r\n            return true;\r\n        }\r\n        else return false;\r\n    }\r\n}\r\n\r\nexport { BufferHolder }\n\n\n// WEBPACK FOOTER //\n// ./src/view/BufferHolder.js","module.exports = __webpack_public_path__ + \"be4a969e74158efbd26dd90fdfcbb43e.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader!./src/view/assets/circle-32.png\n// module id = 16\n// module chunks = 0","module.exports = __webpack_public_path__ + \"420d5510d0798b6c420a170b065a987c.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader!./src/view/assets/circle-64.png\n// module id = 17\n// module chunks = 0","module.exports = __webpack_public_path__ + \"9a89ebcac8efafb00dbc7cb521823273.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader!./src/view/assets/triangle-32.png\n// module id = 18\n// module chunks = 0","module.exports = __webpack_public_path__ + \"d9243fe8aeba146dee38d93f7dcbc66d.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader!./src/view/assets/triangle-64.png\n// module id = 19\n// module chunks = 0","import { DrawingController } from './view/DrawingController.js';\r\nimport { Playback } from './modell/Playback.js';\r\nimport { DataProvider } from './modell/DataProvider.js';\r\nimport { MapInteractionController } from './view/MapInteractionController.js';\r\nimport { MapState } from './view/MapState.js';\r\nimport { Rectangle } from './contracts/Rectangle.js';\r\nimport Configuration from './contracts/Configuration.js';\r\n\r\nclass Webvis {\r\n\r\n    get firstTimestep() {\r\n        return this._config.firstTimestep;\r\n    }\r\n\r\n    get lastTimestep() {\r\n        return this._config.lastTimestep;\r\n    }\r\n\r\n    get timestepSize() {\r\n        return this._config.timestepSize;\r\n    }\r\n\r\n    get playbackSpeedFactor() {\r\n        return this.playback.speedFactor;\r\n    }\r\n\r\n    set onServerConfigChanged(value) {\r\n        this._onServerConfigChanged = value;\r\n    }\r\n\r\n    set onTimestepChanged(value) {\r\n        this.playback.onTimestepChanged = value;\r\n    }\r\n\r\n    set onFetchingData(value) {\r\n        this._onFetchingData = value;\r\n    }\r\n\r\n    /**\r\n     * Constructor for the webvis Wrapper. It loads everything necessary for starting a Matsim visualization\r\n     * Call this constructor only after \"DOMContentLoaded\" event!\r\n     * @param {object} configuration - A configuration Object with a lot of stuff inside\r\n     */\r\n    constructor(configParameters) {\r\n\r\n        Configuration.createConfiguration(configParameters);\r\n        this._config = Configuration.getConfig();\r\n        this._config.subscribeServerConfigUpdated(() => this._handleServerConfigChanged());\r\n        this.dataProvider = new DataProvider();\r\n        this.dataProvider.loadServerConfig();\r\n        this.dataProvider.isFetchingDataChanged = () => this._handleIsFetchingDataChanged();\r\n\r\n        this.drawingController = new DrawingController();\r\n        this.drawingController.dataProvider = this.dataProvider;\r\n\r\n        this.playback = new Playback(this.dataProvider);\r\n        this.drawingController.playback = this.playback;\r\n    }\r\n\r\n    /**\r\n     * Starts playback of the qSim from current Timestep\r\n     */\r\n    startPlayback() {\r\n        this.drawingController.startPlayback();\r\n    }\r\n\r\n    /**\r\n     * Stops playback of the qSim\r\n     */\r\n    stopPlayback() {\r\n        this.drawingController.stopPlayback();\r\n    }\r\n\r\n    /**\r\n     * Sets the timestep of the playback to the provided timestep\r\n     * @param {number} timestep - Timesteps for the next frame, should be between last and first timestep\r\n     */\r\n    seekTimestep(timestep) {\r\n        this.playback.seekTimestep(timestep);\r\n    }\r\n\r\n    /**\r\n     * Sets the speed of the playback. Simple speed is multiplied by the provided factor.\r\n     * If factor is e.g. 2.0 every other frame is skipped, thus the animation runs twice as fast\r\n     * @param {number} factor - The playback speed is multiplied by the supplied factor\r\n     */\r\n    setPlaybackSpeed(factor) {\r\n        this.playback.speedFactor = factor;\r\n    }\r\n\r\n    addGeoJsonLayer(geoJson, layerName, z, color) {\r\n        this.dataProvider.addGeoJsonLayer(geoJson, layerName, -z, color);\r\n    }\r\n\r\n    removeGeoJsonLayer(layerName) {\r\n        this.dataProvider.removeGeoJsonLayer(layerName);\r\n    }\r\n\r\n    destroy() {\r\n\r\n        //kill all members\r\n        this.dataProvider.destroy();\r\n        this.drawingController.destroy();\r\n        this.playback.destroy();\r\n        this._config.destroy();\r\n\r\n        //remove all delegates\r\n        this._onFetchingData = null;\r\n        this._onServerConfigChanged = null;\r\n    }\r\n\r\n    _handleServerConfigChanged() {\r\n        if (this._onServerConfigChanged) {\r\n            this._onServerConfigChanged();\r\n        }\r\n    }\r\n\r\n    _handleIsFetchingDataChanged() {\r\n        if (this._onFetchingData) {\r\n            this._onFetchingData(this.dataProvider.isFetchingData);\r\n        }\r\n    }\r\n}\r\n\r\nexport { Webvis };\n\n\n// WEBPACK FOOTER //\n// ./src/Webvis.js"],"sourceRoot":""}